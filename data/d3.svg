<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="555px" preserveAspectRatio="none" style="width:628px;height:555px;background:#000000;" version="1.1" viewBox="0 0 628 555" width="628px" zoomAndPan="magnify"><title>Diagram 4: Session Rekey Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="387.9648" x="118.6433" y="37.1182">Diagram 4: Session Rekey Flow</text><g><title>PeerB</title><rect fill="#FFB6C1" height="220.5952" style="stroke:#000000;stroke-width:1;" width="10" x="414.9048" y="207.3506"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="314.1938" width="8" x="154" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="158" x2="158" y1="131.752" y2="445.9458"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="314.1938" width="8" x="415.9048" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="419.9048" x2="419.9048" y1="131.752" y2="445.9458"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="134.6665" y="128.8125">PeerA</text><ellipse cx="158" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M158,89.7373 C162,89.7373 165,89.7373 169,85.7373 C177,85.7373 185,93.7373 185,101.7373 L185,105.7373 C185,109.7373 181,113.7373 177,113.7373 L139,113.7373 C135,113.7373 131,109.7373 131,105.7373 L131,101.7373 C131,93.7373 139,85.7373 147,85.7373 C151,89.7373 154,89.7373 158,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="134.6665" y="459.021">PeerA</text><ellipse cx="158" cy="478.9604" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M158,498.9604 C162,498.9604 165,498.9604 169,494.9604 C177,494.9604 185,502.9604 185,510.9604 L185,514.9604 C185,518.9604 181,522.9604 177,522.9604 L139,522.9604 C135,522.9604 131,518.9604 131,514.9604 L131,510.9604 C131,502.9604 139,494.9604 147,494.9604 C151,498.9604 154,498.9604 158,498.9604" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="396.5576" y="128.8125">PeerB</text><ellipse cx="419.9048" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M419.9048,89.7373 C423.9048,89.7373 426.9048,89.7373 430.9048,85.7373 C438.9048,85.7373 446.9048,93.7373 446.9048,101.7373 L446.9048,105.7373 C446.9048,109.7373 442.9048,113.7373 438.9048,113.7373 L400.9048,113.7373 C396.9048,113.7373 392.9048,109.7373 392.9048,105.7373 L392.9048,101.7373 C392.9048,93.7373 400.9048,85.7373 408.9048,85.7373 C412.9048,89.7373 415.9048,89.7373 419.9048,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="396.5576" y="459.021">PeerB</text><ellipse cx="419.9048" cy="478.9604" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M419.9048,498.9604 C423.9048,498.9604 426.9048,498.9604 430.9048,494.9604 C438.9048,494.9604 446.9048,502.9604 446.9048,510.9604 L446.9048,514.9604 C446.9048,518.9604 442.9048,522.9604 438.9048,522.9604 L400.9048,522.9604 C396.9048,522.9604 392.9048,518.9604 392.9048,514.9604 L392.9048,510.9604 C392.9048,502.9604 400.9048,494.9604 408.9048,494.9604 C412.9048,498.9604 415.9048,498.9604 419.9048,498.9604" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g><title>PeerB</title><rect fill="#FFB6C1" height="220.5952" style="stroke:#000000;stroke-width:1;" width="10" x="414.9048" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="616.2515" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="621.2515" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="621.2515" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="135.9067" x="245.1724" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.4634" x="251.1724" y="168.8218">Rekey Initiation</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="402.9048,203.3506,412.9048,207.3506,402.9048,211.3506,406.9048,207.3506" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="158" x2="408.9048" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="165" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224.6626" x="178.2422" y="202.6211">REKEY_PROPOSE(New_Kyber_CT)</text></g><path d="M429,220.3506 L429,261.3506 L616,261.3506 L616,230.3506 L606,220.3506 L429,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M606,220.3506 L606,230.3506 L616,230.3506 L606,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="79.6821" x="435" y="238.4204">Decapsulate</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.2515" x="435" y="254.2197">Generate new AEAD keys</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="169,284.7485,159,288.7485,169,292.7485,165,288.7485" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="163" x2="413.9048" y1="288.7485" y2="288.7485"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="175" y="284.019">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.7207" x="188.2422" y="284.019">REKEY_ACK</text></g><path d="M10,301.7485 L10,326.7485 L153,326.7485 L153,311.7485 L143,301.7485 L10,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M143,301.7485 L143,311.7485 L153,311.7485 L143,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.4272" x="16" y="319.8184">Confirm key install</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="616.2515" x="5" y="353.4475"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="621.2515" y1="353.4475" y2="353.4475"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="621.2515" y1="356.4475" y2="356.4475"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="139.9121" x="243.1697" y="342.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.4688" x="249.1697" y="359.6177">Post-Rekey Data</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="402.9048,394.1465,412.9048,398.1465,402.9048,402.1465,406.9048,398.1465" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="158" x2="408.9048" y1="398.1465" y2="398.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="165" y="393.417">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.2808" x="178.2422" y="393.417">ENC_MSG[1]</text></g><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="169,423.9458,159,427.9458,169,431.9458,165,427.9458" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="163" x2="418.9048" y1="427.9458" y2="427.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="175" y="423.2163">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95.6909" x="188.2422" y="423.2163">ENC_REPLY[1]</text></g><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="3.5156" x="310.8679" y="540.0142">&#160;</text><!--SRC=[VPDVQzim5CNVzIbktS6sXq8AOriB6TYE4aR-6RileIj6IMvI4KVA9BaXb7ttIRBJsKiJlVdUdyuvrzU-Ci-uHTWLZ0j2FiAWa7DMm9Af3VWMqHikTaonBSpPOhDMiXJBM1PImNN7dmQnn1Kh2zENmjH8tn-dF946TOCLzXbU2K3qlsnzntQaMg9gcm4qrElQ7wSVBenKJGFc2fav50XiZrgsPl5DRvyPL2ZDOOUdiLjcTSsRPVYxHB50q5QVYtL3MHzRJdp4LpZY0bkJl8c_TS-yM824ASCNVCU4UL-Ynr-uBPzNE0ANRfyPqfSqkVgGK9hcOHvFHzCKgjE5uFhxjvZIA3W2qGdGxqTVuri7ZCFimIAUgoa7t7KelUiu89jPOFoEWZi18TM-WWHHXG4m3Ka8hLnD8gg825h1237Ss8-XnzdQBUhBlLsZrbmAI7631-WNSc-TIYD5kPsZ8gJRhLi_1JUS6STskyHwtpost9z-MBjxIEcGpl8adIRJZ7wQu3uV7gnG7ZzyTldu2xFV_4ak_oSeldusNgI72xRJPM7PNsA00fMx9N0F8GrxOEDeGgp8CKBqBq9uZ136mqgsm9NnzLYA5LTRTnsuq8OLXPylaThSL4Fsc64NnwEJE1zdWyVR9t8XWQDIcenc5RV4nkI4hAIDPVSK_0K0]--></g></svg>