<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="777px" preserveAspectRatio="none" style="width:555px;height:777px;background:#000000;" version="1.1" viewBox="0 0 555 777" width="555px" zoomAndPan="magnify"><title>Case 1: Peer-to-Peer Communication Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="522.5322" x="15" y="37.1182">Case 1: Peer-to-Peer Communication Flow</text><g><title>PeerA</title><rect fill="#87CEEB" height="442.9897" style="stroke:#000000;stroke-width:1;" width="10" x="162.6499" y="207.3506"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="536.5884" width="8" x="163.6499" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="167.6499" x2="167.6499" y1="131.752" y2="668.3403"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="536.5884" width="8" x="332.2993" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="336.2993" x2="336.2993" y1="131.752" y2="668.3403"/></g><g><title>Bridge channel</title><rect fill="#000000" fill-opacity="0.00000" height="536.5884" width="8" x="432.5908" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="436.2993" x2="436.2993" y1="131.752" y2="668.3403"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="144.3164" y="128.8125">PeerA</text><ellipse cx="167.6499" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M167.6499,89.7373 C171.6499,89.7373 174.6499,89.7373 178.6499,85.7373 C186.6499,85.7373 194.6499,93.7373 194.6499,101.7373 L194.6499,105.7373 C194.6499,109.7373 190.6499,113.7373 186.6499,113.7373 L148.6499,113.7373 C144.6499,113.7373 140.6499,109.7373 140.6499,105.7373 L140.6499,101.7373 C140.6499,93.7373 148.6499,85.7373 156.6499,85.7373 C160.6499,89.7373 163.6499,89.7373 167.6499,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="144.3164" y="681.4155">PeerA</text><ellipse cx="167.6499" cy="701.355" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M167.6499,721.355 C171.6499,721.355 174.6499,721.355 178.6499,717.355 C186.6499,717.355 194.6499,725.355 194.6499,733.355 L194.6499,737.355 C194.6499,741.355 190.6499,745.355 186.6499,745.355 L148.6499,745.355 C144.6499,745.355 140.6499,741.355 140.6499,737.355 L140.6499,733.355 C140.6499,725.355 148.6499,717.355 156.6499,717.355 C160.6499,721.355 163.6499,721.355 167.6499,721.355" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="312.9521" y="128.8125">PeerB</text><ellipse cx="336.2993" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M336.2993,89.7373 C340.2993,89.7373 343.2993,89.7373 347.2993,85.7373 C355.2993,85.7373 363.2993,93.7373 363.2993,101.7373 L363.2993,105.7373 C363.2993,109.7373 359.2993,113.7373 355.2993,113.7373 L317.2993,113.7373 C313.2993,113.7373 309.2993,109.7373 309.2993,105.7373 L309.2993,101.7373 C309.2993,93.7373 317.2993,85.7373 325.2993,85.7373 C329.2993,89.7373 332.2993,89.7373 336.2993,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="312.9521" y="681.4155">PeerB</text><ellipse cx="336.2993" cy="701.355" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M336.2993,721.355 C340.2993,721.355 343.2993,721.355 347.2993,717.355 C355.2993,717.355 363.2993,725.355 363.2993,733.355 L363.2993,737.355 C363.2993,741.355 359.2993,745.355 355.2993,745.355 L317.2993,745.355 C313.2993,745.355 309.2993,741.355 309.2993,737.355 L309.2993,733.355 C309.2993,725.355 317.2993,717.355 325.2993,717.355 C329.2993,721.355 332.2993,721.355 336.2993,721.355" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="SC"><path d="M379.2993,104.7373 L493.8823,104.7373 C498.8823,104.7373 498.8823,118.2446 498.8823,118.2446 C498.8823,118.2446 498.8823,131.752 493.8823,131.752 L379.2993,131.752 C374.2993,131.752 374.2993,118.2446 374.2993,118.2446 C374.2993,118.2446 374.2993,104.7373 379.2993,104.7373" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M493.8823,104.7373 C488.8823,104.7373 488.8823,118.2446 488.8823,118.2446 C488.8823,131.752 493.8823,131.752 493.8823,131.752" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="379.2993" y="123.8125">Bridge channel</text></g><g class="participant participant-tail" data-participant="SC"><path d="M379.2993,667.3403 L493.8823,667.3403 C498.8823,667.3403 498.8823,680.8477 498.8823,680.8477 C498.8823,680.8477 498.8823,694.355 493.8823,694.355 L379.2993,694.355 C374.2993,694.355 374.2993,680.8477 374.2993,680.8477 C374.2993,680.8477 374.2993,667.3403 379.2993,667.3403" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M493.8823,667.3403 C488.8823,667.3403 488.8823,680.8477 488.8823,680.8477 C488.8823,694.355 493.8823,694.355 493.8823,694.355" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="379.2993" y="686.4155">Bridge channel</text></g><g><title>PeerA</title><rect fill="#87CEEB" height="442.9897" style="stroke:#000000;stroke-width:1;" width="10" x="162.6499" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="185.501" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="191.501" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="183.6499,203.3506,173.6499,207.3506,183.6499,211.3506,179.6499,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="177.6499" x2="335.2993" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="189.6499" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.6079" x="202.8921" y="202.6211">Kyber Ciphertext</text></g><path d="M177.6499,220.3506 L177.6499,261.3506 L337.6499,261.3506 L337.6499,230.3506 L327.6499,220.3506 L177.6499,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M327.6499,220.3506 L327.6499,230.3506 L337.6499,230.3506 L327.6499,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.9087" x="183.6499" y="238.4204">1. Decapsulate Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112.0679" x="183.6499" y="254.2197">2. HKDF-SHA384</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="324.2993,284.7485,334.2993,288.7485,324.2993,292.7485,328.2993,288.7485" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="172.6499" x2="330.2993" y1="288.7485" y2="288.7485"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="179.6499" y="284.019">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105.9551" x="192.8921" y="284.019">Session Confirm</text></g><path d="M238.6499,301.7485 L238.6499,342.7485 L330.6499,342.7485 L330.6499,311.7485 L320.6499,301.7485 L238.6499,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M320.6499,301.7485 L320.6499,311.7485 L330.6499,311.7485 L320.6499,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71.5" x="244.6499" y="319.8184">Verify MAC</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9688" x="244.6499" y="335.6177">Init AEAD</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="369.2468"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="369.2468" y2="369.2468"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="372.2468" y2="372.2468"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="127.1216" x="213.2053" y="358.3472"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.6782" x="219.2053" y="375.417">Data Exchange</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="183.6499,409.9458,173.6499,413.9458,183.6499,417.9458,179.6499,413.9458" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="177.6499" x2="335.2993" y1="413.9458" y2="413.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="189.6499" y="409.2163">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.3184" x="202.8921" y="409.2163">AUTH_DATA[0]</text></g><path d="M340.6499,426.9458 L340.6499,467.9458 L493.6499,467.9458 L493.6499,436.9458 L483.6499,426.9458 L340.6499,426.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M483.6499,426.9458 L483.6499,436.9458 L493.6499,436.9458 L483.6499,426.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="346.6499" y="445.0156">ChaCha20-Poly1305</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="59.998" x="346.6499" y="460.8149">Seq: 001</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="324.2993,491.3438,334.2993,495.3438,324.2993,499.3438,328.2993,495.3438" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="172.6499" x2="330.2993" y1="495.3438" y2="495.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="179.6499" y="490.6143">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.4072" x="192.8921" y="490.6143">ENC_RESPONSE[0]</text></g><path d="M54.6499,508.3438 L54.6499,549.3438 L157.6499,549.3438 L157.6499,518.3438 L147.6499,508.3438 L54.6499,508.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M147.6499,508.3438 L147.6499,518.3438 L157.6499,518.3438 L147.6499,508.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2656" x="60.6499" y="526.4136">Rate Limited</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="75.6577" x="60.6499" y="542.2129">Anti-Replay</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="575.842"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="575.842" y2="575.842"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="578.842" y2="578.842"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="174.5894" x="189.4714" y="564.9424"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.146" x="195.4714" y="582.0122">Channel Maintenance</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="424.5908,616.541,434.5908,620.541,424.5908,624.541,428.5908,620.541" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="336.2993" x2="430.5908" y1="620.541" y2="620.541"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="343.2993" y="615.8115">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9751" x="356.5415" y="615.8115">Keepalive</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="178.6499,646.3403,168.6499,650.3403,178.6499,654.3403,174.6499,650.3403" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="172.6499" x2="435.5908" y1="650.3403" y2="650.3403"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="184.6499" y="645.6108">6</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.7651" x="197.8921" y="645.6108">Heartbeat</text></g><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="249.4434" x="151.5444" y="762.4087">Secure Messaging Protocol v1.4 | IETF-Compliant</text><!--SRC=[bLLhJzim5FtkNt4fIFjKrF8O3wcJaZG5H0jTmwOXGCXDRrgBnCuS1-ZO_lkkam8fVMYpghQvz_YUSn-nDym44uGqva8ozWbEOZNaCOouVe3IbQ4nGeupbZq8cNBD4nZoy66iLIv7degLXir6iIg84KOyZqr7IJE3T8fbAIwKeQWfXY8IuRBmqW9U6D1oFpBDmXG-fKUevnLOUuLqPlrZQPtGa6c15-gGP_G74YLLED7AfcocCLO4SRiri4RWJvWHvADp9ZSmg56PQOgBcN-GDhCMqZmoQnMlBKeumxoi2FHg3SGlXER1qkfjzPpWoX_SzttwyYwxbuE5Ggw0126FyGSqj_VV7w-BnoA1hpdcwtlwiq3yPrENLwxQr00fi0pBbX5bXJ5xTPMaNH5XLqXSHV3cNp7R5jFdseXGf5oQLM5EQ6kwBaO9KAFfFu3MK2mVWBPu5BHdNUXNo8hWC_VAGILJnZQsYl5moW615jGs3myyttThv5eOeC9_rF3zeqRjTQjRSNKwxcUlQLt1DMtjpRdiAgBwlSl1zLANEpXhd_WLLnJPR6jMSALZ6IlVr5eVKJiru1dq7PZBf8fmIuGBSu9PESSrLulH626SS2anBg211tDI63F2q8dXyOnUo6EmGUj6rUql5J99SYb2ReIIq8dL4sCyDqhcoH0rQxLeihFC-lpCy64iiac2qa2hnHXfgj_CgRhxGgaSm_bqQ4EBT8BQuBEnwOX7JeVfGgB54Ql5U6AAdSrjQ6F8qooFBRm8T2jtjk7qlDsf1wVExk4U4JjlnCuxiNlyffNEiKZef8mUOsGAxtVK8ff2p_5kvPaK1XpVQJEROviR3lwphI8LSsrkphUhq_ksS-NSDExcr1E1D-7qsMdK-ogUDdSR-xUIpeLZQ3IQQqJx5zxzm0_wbnU1_nQq54ry0rk7haY4mT6jTAGHzG7IBJajX7jbtw57jwP1oUqnir9-u55h45CUYqTaD2O4gGxABCDJf5aT8ZUCZR3IESOYHT9eB0CCSutGeshpiRso-beP5TAbyDZSteFVSEPVTUeqMcaiQE1hVm40]--></g></svg>