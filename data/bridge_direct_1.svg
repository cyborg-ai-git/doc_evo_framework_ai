<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="605px" preserveAspectRatio="none" style="width:875px;height:605px;background:#000000;" version="1.1" viewBox="0 0 875 605" width="875px" zoomAndPan="magnify"><title>PeerB get_peer PeerA certificate from Master Peer</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="626.8711" x="122.9075" y="37.1182">PeerB get_peer PeerA certificate from Master Peer</text><g><title>PeerA</title><rect fill="#87CEEB" height="295.9932" style="stroke:#000000;stroke-width:1;" width="10" x="569.2793" y="207.3506"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="191" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="195" x2="195" y1="131.752" y2="521.3438"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="570.2793" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="574.2793" x2="574.2793" y1="131.752" y2="521.3438"/></g><g><title>Bridge channel</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="677.2866" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="680.9951" x2="680.9951" y1="131.752" y2="521.3438"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="171.6528" y="128.8125">PeerB</text><ellipse cx="195" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M195,89.7373 C199,89.7373 202,89.7373 206,85.7373 C214,85.7373 222,93.7373 222,101.7373 L222,105.7373 C222,109.7373 218,113.7373 214,113.7373 L176,113.7373 C172,113.7373 168,109.7373 168,105.7373 L168,101.7373 C168,93.7373 176,85.7373 184,85.7373 C188,89.7373 191,89.7373 195,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="171.6528" y="534.4189">PeerB</text><ellipse cx="195" cy="554.3584" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M195,574.3584 C199,574.3584 202,574.3584 206,570.3584 C214,570.3584 222,578.3584 222,586.3584 L222,590.3584 C222,594.3584 218,598.3584 214,598.3584 L176,598.3584 C172,598.3584 168,594.3584 168,590.3584 L168,586.3584 C168,578.3584 176,570.3584 184,570.3584 C188,574.3584 191,574.3584 195,574.3584" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="550.9458" y="128.8125">PeerA</text><ellipse cx="574.2793" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M574.2793,89.7373 C578.2793,89.7373 581.2793,89.7373 585.2793,85.7373 C593.2793,85.7373 601.2793,93.7373 601.2793,101.7373 L601.2793,105.7373 C601.2793,109.7373 597.2793,113.7373 593.2793,113.7373 L555.2793,113.7373 C551.2793,113.7373 547.2793,109.7373 547.2793,105.7373 L547.2793,101.7373 C547.2793,93.7373 555.2793,85.7373 563.2793,85.7373 C567.2793,89.7373 570.2793,89.7373 574.2793,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="550.9458" y="534.4189">PeerA</text><ellipse cx="574.2793" cy="554.3584" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M574.2793,574.3584 C578.2793,574.3584 581.2793,574.3584 585.2793,570.3584 C593.2793,570.3584 601.2793,578.3584 601.2793,586.3584 L601.2793,590.3584 C601.2793,594.3584 597.2793,598.3584 593.2793,598.3584 L555.2793,598.3584 C551.2793,598.3584 547.2793,594.3584 547.2793,590.3584 L547.2793,586.3584 C547.2793,578.3584 555.2793,570.3584 563.2793,570.3584 C567.2793,574.3584 570.2793,574.3584 574.2793,574.3584" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="SC"><path d="M623.9951,104.7373 L738.5781,104.7373 C743.5781,104.7373 743.5781,118.2446 743.5781,118.2446 C743.5781,118.2446 743.5781,131.752 738.5781,131.752 L623.9951,131.752 C618.9951,131.752 618.9951,118.2446 618.9951,118.2446 C618.9951,118.2446 618.9951,104.7373 623.9951,104.7373" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M738.5781,104.7373 C733.5781,104.7373 733.5781,118.2446 733.5781,118.2446 C733.5781,131.752 738.5781,131.752 738.5781,131.752" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="623.9951" y="123.8125">Bridge channel</text></g><g class="participant participant-tail" data-participant="SC"><path d="M623.9951,520.3438 L738.5781,520.3438 C743.5781,520.3438 743.5781,533.8511 743.5781,533.8511 C743.5781,533.8511 743.5781,547.3584 738.5781,547.3584 L623.9951,547.3584 C618.9951,547.3584 618.9951,533.8511 618.9951,533.8511 C618.9951,533.8511 618.9951,520.3438 623.9951,520.3438" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M738.5781,520.3438 C733.5781,520.3438 733.5781,533.8511 733.5781,533.8511 C733.5781,547.3584 738.5781,547.3584 738.5781,547.3584" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="623.9951" y="539.4189">Bridge channel</text></g><g><title>PeerA</title><rect fill="#87CEEB" height="295.9932" style="stroke:#000000;stroke-width:1;" width="10" x="569.2793" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="863.686" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="345.5779" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="351.5779" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="557.2793,203.3506,567.2793,207.3506,557.2793,211.3506,561.2793,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="195" x2="563.2793" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="202" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="342.0371" x="215.2422" y="202.6211">EApiEvent(Kyber Ciphertext,Api request, id_peer_b)</text></g><path d="M584,220.3506 L584,277.3506 L863,277.3506 L863,230.3506 L853,220.3506 L584,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M853,220.3506 L853,230.3506 L863,230.3506 L853,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.9087" x="590" y="238.4204">1. Decapsulate Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2402" x="590" y="254.2197">2.Verify sign</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="258.686" x="590" y="270.019">3. get_peer PeerB (cache, Master Peer)</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="206,300.5479,196,304.5479,206,308.5479,202,304.5479" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="200" x2="568.2793" y1="304.5479" y2="304.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="212" y="299.8184">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="176.2808" x="225.2422" y="299.8184">Recive EApiEvent response</text></g><path d="M10,317.5479 L10,358.5479 L190,358.5479 L190,327.5479 L180,317.5479 L10,317.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M180,317.5479 L180,327.5479 L190,327.5479 L180,317.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.9121" x="16" y="335.6177">1. Decrypt EApiEvent</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.3389" x="16" y="351.417">2. Store new Secret Key</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="863.686" x="5" y="385.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="385.0461" y2="385.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="388.0461" y2="388.0461"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="299.3652" x="287.1604" y="374.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280.9219" x="293.1604" y="391.2163">Other EApiEvent Request/Response ...</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="863.686" x="5" y="428.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="428.8455" y2="428.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="868.686" y1="431.8455" y2="431.8455"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="174.5894" x="349.5483" y="417.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.146" x="355.5483" y="435.0156">Channel Maintenance</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="669.2866,469.5444,679.2866,473.5444,669.2866,477.5444,673.2866,473.5444" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="195" x2="675.2866" y1="473.5444" y2="473.5444"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="202" y="468.8149">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9751" x="215.2422" y="468.8149">Keepalive</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="585.2793,499.3438,575.2793,503.3438,585.2793,507.3438,581.2793,503.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="579.2793" x2="680.2866" y1="503.3438" y2="503.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="591.2793" y="498.6143">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.7651" x="604.5215" y="498.6143">Heartbeat</text></g><!--SRC=[bLNlJzim4Ftkl-8eI0C9EhffOo1rKX82cw1hrqpJq9YGcrvRYzJERBUiG_lVTtPIcj8VsloXIkwUxxrtlhWxTeHZX3pZGZBs0YuprUCPzBc-Xo9bq5eXXuQPUo5phlaOUZoz7seraVr8PKh3xh5V5KGV1toIsGibRGcvyCjHV5AMgkQOYe58rvMN3l38W5RudAaiutDAzr4lAt3n2caP_UDeWzHIQ8KNZc1Yw076Igfqf9MpR6SPLWHnjpLnGU0FQ0ZoF5dAJIngL7QMuwhpPzBAg9SMKLYhR6jJqXBpkA7GF9g8tmYDaxNTssi5oPUuUzU9wITgNxUxAutS04bIdk4tQDJVB5vl_Aity7c2a-rd-jCZ_lDGrtUkUgW9Kc6P5aT6b1L6CqyLfDTYWDT2uYQ2f_o6sNQO3jTMf2BdqcugSqbRysqr2e3gp_u1j8LY_G2SYwcWFTjApo4RYfVfZODA8SDszlnu1CM0G1Dgk-zEeZWEQvHQ6I2VFpsEuzFZsdnhM4bTN8HleuPB9JUqjRMKSijNZLljxitQLDZzU7uPLrA3WNDRSu8h9sPOyQNMEaZsQy0DT49OabD510KYW2Mlh9ZZMgX5VuYGZhYKc7be4i6I5CQii7HZU3eOehtBwSc_1f0YwQ9FXTDDDw0x1rhSs38BZF69LN8oxg5cpIODkJ52IOYDvRrCcD4OfOLcap4oSFHzoSAFzwJv3E8W5_6KOFjNCwe2aSX7H8c_x25bGBjlmzX347slwgvtuBoBgTEpujdVnreCHzRNRjJX75EUcqdcu9xWLhwgVqKj1ZCmOYXlvUlwikKGzbEUZl2mwlI070HF3eA5W_0CkdINJ75XX3IRN4c3XPmC1zRZ2ZLwbji5rgcXkrXf18aFrBzKeuKhd37NpZRzh-bAuMxHZ9VTaW3gzRhlhWD7nGcJQY4jIkukb8sTJw8pOi6SPoITqK0Gf3eIvU5yG9hA7dBBM1yhRVyB]--></g></svg>