@startuml
!theme plain

' Colour constants
!define PEER_A_COLOR      #87CEEB
!define MASTER_PEER_COLOR #90EE90
!define SYSTEM_COLOR      #FFFFFF

' Global styling
skinparam backgroundColor #000000
skinparam defaultFontColor #FFFFFF
skinparam actorStyle awesome
skinparam note {
  BackgroundColor #FFFFFF
  BorderColor #000000
  FontColor #000000
}

' Sequence styling
skinparam sequence {
  LifeLineBorderColor #FFFFFF
  LifeLineBackgroundColor #000000
  ParticipantBorderColor #FFFFFF
  DividerBackgroundColor #000000
  DividerBorderColor #FFFFFF
  DividerFontColor #FFFFFF
}

' Participants
actor "PeerA"      as PA PEER_A_COLOR
actor "MasterPeer" as MP MASTER_PEER_COLOR

title Diagram 3: Identity Establishment Flow
autonumber

== Key Generation & Claim ==
PA -> PA: Generate Kyber-1024 Key Pair
note left PA: - Follows NIST SP 800-56C\n- Store private key locally

PA -> PA: Derive Peer ID\nSHA3-256(Public Key)
note left PA: 32-byte unique identifier

PA -> PA: Self-sign identity claim\n(Dilithium-5)

== Encrypted Claim Submission ==
PA -[PEER_A_COLOR]> MP: ENC_IDENTITY_CLAIM
note right MP: ChaCha20-Poly1305\nKey from Kyber KEM

@enduml