<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="695px" preserveAspectRatio="none" style="width:646px;height:695px;background:#000000;" version="1.1" viewBox="0 0 646 695" width="646px" zoomAndPan="magnify"><title>Diagram 5: Certificate Retrieval Protocol</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="501.7031" x="71.0378" y="37.1182">Diagram 5: Certificate Retrieval Protocol</text><g><title>MasterPeer</title><rect fill="#000000" height="349.9932" style="stroke:#000000;stroke-width:1;" width="10" x="367.1899" y="207.3506"/></g><g><title>CertDB</title><rect fill="#000000" height="29.7993" style="stroke:#000000;stroke-width:1;" width="10" x="601.7832" y="375.3472"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="479.3911" width="8" x="177" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="181" x2="181" y1="131.752" y2="611.1431"/></g><g><title>MasterPeer</title><rect fill="#000000" fill-opacity="0.00000" height="479.3911" width="8" x="368.1899" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="371.9756" x2="371.9756" y1="131.752" y2="611.1431"/></g><g><title>CertDB</title><rect fill="#000000" fill-opacity="0.00000" height="479.3911" width="8" x="602.7832" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="605.7876" x2="605.7876" y1="131.752" y2="611.1431"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="157.6528" y="128.8125">PeerB</text><ellipse cx="181" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M181,89.7373 C185,89.7373 188,89.7373 192,85.7373 C200,85.7373 208,93.7373 208,101.7373 L208,105.7373 C208,109.7373 204,113.7373 200,113.7373 L162,113.7373 C158,113.7373 154,109.7373 154,105.7373 L154,101.7373 C154,93.7373 162,85.7373 170,85.7373 C174,89.7373 177,89.7373 181,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="157.6528" y="624.2183">PeerB</text><ellipse cx="181" cy="644.1577" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M181,664.1577 C185,664.1577 188,664.1577 192,660.1577 C200,660.1577 208,668.1577 208,676.1577 L208,680.1577 C208,684.1577 204,688.1577 200,688.1577 L162,688.1577 C158,688.1577 154,684.1577 154,680.1577 L154,676.1577 C154,668.1577 162,660.1577 170,660.1577 C174,664.1577 177,664.1577 181,664.1577" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="329.9756" y="128.8125">MasterPeer</text><ellipse cx="372.1899" cy="69.7373" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M372.1899,89.7373 C376.1899,89.7373 379.1899,89.7373 383.1899,85.7373 C391.1899,85.7373 399.1899,93.7373 399.1899,101.7373 L399.1899,105.7373 C399.1899,109.7373 395.1899,113.7373 391.1899,113.7373 L353.1899,113.7373 C349.1899,113.7373 345.1899,109.7373 345.1899,105.7373 L345.1899,101.7373 C345.1899,93.7373 353.1899,85.7373 361.1899,85.7373 C365.1899,89.7373 368.1899,89.7373 372.1899,89.7373" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="329.9756" y="624.2183">MasterPeer</text><ellipse cx="372.1899" cy="644.1577" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M372.1899,664.1577 C376.1899,664.1577 379.1899,664.1577 383.1899,660.1577 C391.1899,660.1577 399.1899,668.1577 399.1899,676.1577 L399.1899,680.1577 C399.1899,684.1577 395.1899,688.1577 391.1899,688.1577 L353.1899,688.1577 C349.1899,688.1577 345.1899,684.1577 345.1899,680.1577 L345.1899,676.1577 C345.1899,668.1577 353.1899,660.1577 361.1899,660.1577 C365.1899,664.1577 368.1899,664.1577 372.1899,664.1577" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="DB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="578.7876" y="128.8125">CertDB</text><path d="M588.7832,78.7373 C588.7832,68.7373 606.7832,68.7373 606.7832,68.7373 C606.7832,68.7373 624.7832,68.7373 624.7832,78.7373 L624.7832,104.7373 C624.7832,114.7373 606.7832,114.7373 606.7832,114.7373 C606.7832,114.7373 588.7832,114.7373 588.7832,104.7373 L588.7832,78.7373" fill="#FBFF00"/><path d="M588.7832,78.7373 C588.7832,88.7373 606.7832,88.7373 606.7832,88.7373 C606.7832,88.7373 624.7832,88.7373 624.7832,78.7373" fill="none" style="stroke:#FBFF00;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="DB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="578.7876" y="624.2183">CertDB</text><path d="M588.7832,637.1577 C588.7832,627.1577 606.7832,627.1577 606.7832,627.1577 C606.7832,627.1577 624.7832,627.1577 624.7832,637.1577 L624.7832,663.1577 C624.7832,673.1577 606.7832,673.1577 606.7832,673.1577 C606.7832,673.1577 588.7832,673.1577 588.7832,663.1577 L588.7832,637.1577" fill="#FBFF00"/><path d="M588.7832,637.1577 C588.7832,647.1577 606.7832,647.1577 606.7832,647.1577 C606.7832,647.1577 624.7832,647.1577 624.7832,637.1577" fill="none" style="stroke:#FBFF00;stroke-width:1;"/></g><g><title>MasterPeer</title><rect fill="#000000" height="349.9932" style="stroke:#000000;stroke-width:1;" width="10" x="367.1899" y="207.3506"/></g><g><title>CertDB</title><rect fill="#000000" height="29.7993" style="stroke:#000000;stroke-width:1;" width="10" x="601.7832" y="375.3472"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="634.7788" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="126.125" x="259.3269" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107.6816" x="265.3269" y="168.8218">Request Phase</text><g class="message" data-participant-1="PB" data-participant-2="MP"><polygon fill="#FFB6C1" points="355.1899,203.3506,365.1899,207.3506,355.1899,211.3506,359.1899,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="181" x2="361.1899" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="188" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="124.7378" x="201.2422" y="202.6211">ENC_QUERY(ID_A)</text></g><path d="M382,220.3506 L382,261.3506 L525,261.3506 L525,230.3506 L515,220.3506 L382,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M515,220.3506 L515,230.3506 L525,230.3506 L515,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.459" x="388" y="238.4204">KEM decapsulation</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.3447" x="388" y="254.2197">AEAD decryption</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="634.7788" x="5" y="287.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="287.8489" y2="287.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="290.8489" y2="290.8489"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="165.5693" x="239.6047" y="276.9492"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147.126" x="245.6047" y="294.019">Validation &amp; Lookup</text><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#000000;stroke-width:1;" x1="377.1899" x2="419.1899" y1="332.5479" y2="332.5479"/><line style="stroke:#000000;stroke-width:1;" x1="419.1899" x2="419.1899" y1="332.5479" y2="345.5479"/><line style="stroke:#000000;stroke-width:1;" x1="378.1899" x2="419.1899" y1="345.5479" y2="345.5479"/><polygon fill="#000000" points="388.1899,341.5479,378.1899,345.5479,388.1899,349.5479,384.1899,345.5479" style="stroke:#000000;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="384.1899" y="327.8184">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.2949" x="397.4321" y="327.8184">Verify query authorization</text></g><g class="message" data-participant-1="MP" data-participant-2="DB"><polygon fill="#90EE90" points="589.7832,371.3472,599.7832,375.3472,589.7832,379.3472,593.7832,375.3472" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="377.1899" x2="595.7832" y1="375.3472" y2="375.3472"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="384.1899" y="370.6177">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.3691" x="397.4321" y="370.6177">GET_CERT(ID_A)</text></g><g class="message" data-participant-1="DB" data-participant-2="MP"><polygon fill="#FFFFFF" points="388.1899,401.1465,378.1899,405.1465,388.1899,409.1465,384.1899,405.1465" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:2,2;" x1="382.1899" x2="605.7832" y1="405.1465" y2="405.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="394.1899" y="400.417">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.9688" x="407.4321" y="400.417">Certificate Data</text></g><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#000000;stroke-width:1;" x1="377.1899" x2="419.1899" y1="434.9458" y2="434.9458"/><line style="stroke:#000000;stroke-width:1;" x1="419.1899" x2="419.1899" y1="434.9458" y2="447.9458"/><line style="stroke:#000000;stroke-width:1;" x1="378.1899" x2="419.1899" y1="447.9458" y2="447.9458"/><polygon fill="#000000" points="388.1899,443.9458,378.1899,447.9458,388.1899,451.9458,384.1899,447.9458" style="stroke:#000000;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="384.1899" y="430.2163">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="187.3511" x="397.4321" y="430.2163">Sign response with Dilithium</text></g><path d="M175,460.9458 L175,485.9458 L361,485.9458 L361,470.9458 L351,460.9458 L175,460.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M351,460.9458 L351,470.9458 L361,470.9458 L351,460.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.3374" x="181" y="479.0156">Include revocation status</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="634.7788" x="5" y="512.6448"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="512.6448" y2="512.6448"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="639.7788" y1="515.6448" y2="515.6448"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="127.02" x="258.8794" y="501.7451"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.5767" x="264.8794" y="518.8149">Delivery Phase</text><g class="message" data-participant-1="MP" data-participant-2="PB"><polygon fill="#90EE90" points="192,553.3438,182,557.3438,192,561.3438,188,557.3438" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="186" x2="371.1899" y1="557.3438" y2="557.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="198" y="552.6143">6</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.9478" x="211.2422" y="552.6143">ENC_CERT_RESPONSE</text></g><path d="M10,570.3438 L10,595.3438 L176,595.3438 L176,580.3438 L166,570.3438 L10,570.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M166,570.3438 L166,580.3438 L176,580.3438 L166,570.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="145.5708" x="16" y="588.4136">Decrypt &amp; verify chain</text><!--SRC=[VLHTRzem57ttht2fj8y79FQmIQt494BSgXefMT9Lghe9cN03LesTsGuLdVRVTvtmOIYTNn3syJddddlZCxU09T1ASg48UK-7MkhQq48hwxXobfpDe1GAQCfODeacm_5edD5cdLzTHL-6dtQ8P93V8QO1jh3pYnvZ5xqzWYNZxE60evoMPM-Fo1-G8pbIySjxkvPwoYMrRYs5cXFx95J53L_IAI-UvaRNQkRj6thUQrQ0G7fUItUbbTj0DhHx22-SDZbo0-NFOFKImllSyIctGFyGIgCZkR0iVwpD3Cp9eq1_O_5l8AAqEosmDNl8lQKuJOjvvV2x1bN0YSJiziZBZKG98qp_W7mdkJjz8sHAKswSA4I5ytAQ8XOhWTjlCsm1_xlzkdTDaO6u9KqFsxdff824dVOFjpID3aRu09fmwy3u2nqFJTBNiqns4u3u8HWNRxWH7qU7VIPEE9oYMF2vp_hp9VKNH2aAZWtEm1a1Anpar6Yd2oq9hvrMzN8AXf1-7n7O7Ejekl1w_Jv1xzt7qFslhsZoahBRuUJx3vOzVBY99uEFlYQnyXf9IffXCcA-S0tq6qlm8oXuPMl9dT3gfngmGUptpBho6utqFPTYrfpJTtIazLDTUGEOIBULl0SZoZL5WsPDqVT26_7IN6X0Zw-2GwjnT4clsTraoBAxOwTnH32-RlSn_F8tvOMfnHW_cK5uBt2LYxcY1co5pnRGP-4McBx47r4lsoGab6qGDwgGzGoZWPKksahnfNErRUgFGOgLBssN_PjLfL7R05_L96DvEhxDMI3cp-CsNSnorUPMBFmx6zI1dVe7]--></g></svg>