<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="668px" preserveAspectRatio="none" style="width:673px;height:668px;background:#000000;" version="1.1" viewBox="0 0 673 668" width="673px" zoomAndPan="magnify"><title>Diagram 4: Certificate Issuance Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="457.6172" x="106.4609" y="37.1182">Diagram 4: Certificate Issuance Flow</text><g><title>CertDB</title><rect fill="#000000" height="29.7993" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="419.5176" y="455.7451"/></g><g><title>MasterPeer</title><rect fill="#000000" fill-opacity="0.00000" height="453.1904" width="8" x="188.2144" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="192" x2="192" y1="131.752" y2="584.9424"/></g><g><title>CertDB</title><rect fill="#000000" fill-opacity="0.00000" height="453.1904" width="8" x="420.5176" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="423.522" x2="423.522" y1="131.752" y2="584.9424"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="453.1904" width="8" x="486.5132" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="490.5132" x2="490.5132" y1="131.752" y2="584.9424"/></g><g class="participant participant-head" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="150" y="128.8125">MasterPeer</text><ellipse cx="192.2144" cy="69.7373" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M192.2144,89.7373 C196.2144,89.7373 199.2144,89.7373 203.2144,85.7373 C211.2144,85.7373 219.2144,93.7373 219.2144,101.7373 L219.2144,105.7373 C219.2144,109.7373 215.2144,113.7373 211.2144,113.7373 L173.2144,113.7373 C169.2144,113.7373 165.2144,109.7373 165.2144,105.7373 L165.2144,101.7373 C165.2144,93.7373 173.2144,85.7373 181.2144,85.7373 C185.2144,89.7373 188.2144,89.7373 192.2144,89.7373" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="150" y="598.0176">MasterPeer</text><ellipse cx="192.2144" cy="617.957" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M192.2144,637.957 C196.2144,637.957 199.2144,637.957 203.2144,633.957 C211.2144,633.957 219.2144,641.957 219.2144,649.957 L219.2144,653.957 C219.2144,657.957 215.2144,661.957 211.2144,661.957 L173.2144,661.957 C169.2144,661.957 165.2144,657.957 165.2144,653.957 L165.2144,649.957 C165.2144,641.957 173.2144,633.957 181.2144,633.957 C185.2144,637.957 188.2144,637.957 192.2144,637.957" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="DB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="396.522" y="128.8125">CertDB</text><path d="M406.5176,78.7373 C406.5176,68.7373 424.5176,68.7373 424.5176,68.7373 C424.5176,68.7373 442.5176,68.7373 442.5176,78.7373 L442.5176,104.7373 C442.5176,114.7373 424.5176,114.7373 424.5176,114.7373 C424.5176,114.7373 406.5176,114.7373 406.5176,104.7373 L406.5176,78.7373" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M406.5176,78.7373 C406.5176,88.7373 424.5176,88.7373 424.5176,88.7373 C424.5176,88.7373 442.5176,88.7373 442.5176,78.7373" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="DB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="396.522" y="598.0176">CertDB</text><path d="M406.5176,610.957 C406.5176,600.957 424.5176,600.957 424.5176,600.957 C424.5176,600.957 442.5176,600.957 442.5176,610.957 L442.5176,636.957 C442.5176,646.957 424.5176,646.957 424.5176,646.957 C424.5176,646.957 406.5176,646.957 406.5176,636.957 L406.5176,610.957" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M406.5176,610.957 C406.5176,620.957 424.5176,620.957 424.5176,620.957 C424.5176,620.957 442.5176,620.957 442.5176,610.957" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="467.1797" y="128.8125">PeerA</text><ellipse cx="490.5132" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M490.5132,89.7373 C494.5132,89.7373 497.5132,89.7373 501.5132,85.7373 C509.5132,85.7373 517.5132,93.7373 517.5132,101.7373 L517.5132,105.7373 C517.5132,109.7373 513.5132,113.7373 509.5132,113.7373 L471.5132,113.7373 C467.5132,113.7373 463.5132,109.7373 463.5132,105.7373 L463.5132,101.7373 C463.5132,93.7373 471.5132,85.7373 479.5132,85.7373 C483.5132,89.7373 486.5132,89.7373 490.5132,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="467.1797" y="598.0176">PeerA</text><ellipse cx="490.5132" cy="617.957" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M490.5132,637.957 C494.5132,637.957 497.5132,637.957 501.5132,633.957 C509.5132,633.957 517.5132,641.957 517.5132,649.957 L517.5132,653.957 C517.5132,657.957 513.5132,661.957 509.5132,661.957 L471.5132,661.957 C467.5132,661.957 463.5132,657.957 463.5132,653.957 L463.5132,649.957 C463.5132,641.957 471.5132,633.957 479.5132,633.957 C483.5132,637.957 486.5132,637.957 490.5132,637.957" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g><title>CertDB</title><rect fill="#000000" height="29.7993" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="419.5176" y="455.7451"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="661.5391" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="666.5391" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="666.5391" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="143.0352" x="264.252" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="124.5918" x="270.252" y="168.8218">Claim Processing</text><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#000000;stroke-width:1;" x1="192.2144" x2="234.2144" y1="223.1499" y2="223.1499"/><line style="stroke:#000000;stroke-width:1;" x1="234.2144" x2="234.2144" y1="223.1499" y2="236.1499"/><line style="stroke:#000000;stroke-width:1;" x1="193.2144" x2="234.2144" y1="236.1499" y2="236.1499"/><polygon fill="#000000" points="203.2144,232.1499,193.2144,236.1499,203.2144,240.1499,199.2144,236.1499" style="stroke:#000000;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="199.2144" y="210.5208">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.3447" x="212.4565" y="202.6211">Decapsulate Kyber</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.6411" x="212.4565" y="218.4204">Decrypt identity claim</text></g><path d="M32,249.1499 L32,290.1499 L186,290.1499 L186,259.1499 L176,249.1499 L32,249.1499" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M176,249.1499 L176,259.1499 L186,259.1499 L176,249.1499" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.7563" x="38" y="267.2197">Validate format</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="133.7578" x="38" y="283.019">Check self-signature</text><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#000000;stroke-width:1;" x1="192.2144" x2="234.2144" y1="317.5479" y2="317.5479"/><line style="stroke:#000000;stroke-width:1;" x1="234.2144" x2="234.2144" y1="317.5479" y2="330.5479"/><line style="stroke:#000000;stroke-width:1;" x1="193.2144" x2="234.2144" y1="330.5479" y2="330.5479"/><polygon fill="#000000" points="203.2144,326.5479,193.2144,330.5479,203.2144,334.5479,199.2144,330.5479" style="stroke:#000000;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="199.2144" y="312.8184">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.061" x="212.4565" y="312.8184">Generate Dilithium-5 Signature</text></g><path d="M10,343.5479 L10,384.5479 L187,384.5479 L187,353.5479 L177,343.5479 L10,343.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M177,343.5479 L177,353.5479 L187,353.5479 L177,343.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.3521" x="16" y="361.6177">Cert contains:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.9648" x="16" y="377.417">Peer ID, PubKey, Expiry</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="661.5391" x="5" y="411.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="666.5391" y1="411.0461" y2="411.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="666.5391" y1="414.0461" y2="414.0461"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="155.8066" x="257.8662" y="400.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137.3633" x="263.8662" y="417.2163">Storage &amp; Delivery</text><g class="message" data-participant-1="MP" data-participant-2="DB"><polygon fill="#90EE90" points="407.5176,451.7451,417.5176,455.7451,407.5176,459.7451,411.5176,455.7451" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="192.2144" x2="413.5176" y1="455.7451" y2="455.7451"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="199.2144" y="451.0156">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155.5811" x="212.4565" y="451.0156">Store(ID_A, Certificate)</text></g><g class="message" data-participant-1="DB" data-participant-2="MP"><polygon fill="#FFFFFF" points="203.2144,481.5444,193.2144,485.5444,203.2144,489.5444,199.2144,485.5444" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="197.2144" x2="423.5176" y1="485.5444" y2="485.5444"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="209.2144" y="480.8149">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.6401" x="222.4565" y="480.8149">Storage ACK</text></g><g class="message" data-participant-1="MP" data-participant-2="PA"><polygon fill="#90EE90" points="478.5132,511.3438,488.5132,515.3438,478.5132,519.3438,482.5132,515.3438" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="192.2144" x2="484.5132" y1="515.3438" y2="515.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="199.2144" y="510.6143">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.896" x="212.4565" y="510.6143">ENC_CERT_PACKAGE</text></g><path d="M495,528.3438 L495,569.3438 L661,569.3438 L661,538.3438 L651,528.3438 L495,528.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M651,528.3438 L651,538.3438 L661,538.3438 L651,528.3438" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="501" y="546.4136">ChaCha20-Poly1305</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="145.5391" x="501" y="562.2129">Session key from KEM</text><!--SRC=[bLHhQzim5FskNt7RmXxGGFOeMmCfEBPRIfhL96LGcX8KvpeHaQLCajEPiV- -A-THUsq64_waUywvZtEj8xV0764bkL2ClOLGIrqOIBMoZYjdsT4CCw4GaZWUJe99U7jpEuJgd7pz4iPnRuyO1ACxmbJ03Upal1t7v-rdH3ou7TutDB9fbhMV4QDxqXWq49VLyRLTIJtb4gmhfL1pPfT2hRZXEKnvkfmRNQYPBz_0IRiwDGJ9yqAwIwtS5hALVORmr6ap8cq4_eHMvrZdSyUdt2ByOW2z0-aeeiqCpT-tjQpRkzyrQQNT0TbjYVyZIrCQuOy2LOglpCdkGZxTZSZmXcRU4D-dt4SFzffmuqGgLhGbhqj4OYte-h323l0lzal7gYPhoIshdDjio_60MuScGJJ7m2qCafThoVPc4Zv4uwBUSKKcVDHhB6b3sei66wI79a7Zds3C2KUx4ma-zxF-t06lBJAHSZBusjg2-z5VIlt4UE6qAl8f6iQwNGZfxyiXCJf5Qyaow7OPLTwweFex467ALxQGNgPV4cUiwCgKAmSq8KLfIqYz0gjMIMBcAjvtBiNCap9jSkx6AbnWkgGba5dBYhdYhZ38QeckKA7nX4X8uHQYo5jdCDeZc-g-EVzCE7euR6Ui_7JWEZg5f9ZsiJo5-ETAcBBgRqH3v7E4DzIB56iqvQx3XnVkF5wG2PsAWk-keqbmMf_ZU- -8M5T5zXYvrMezrD-CnqqdkuH1s6Sph5CEPqs23iJVmaaO3-yc2J63gtZJin7pXQlYuOBJzx7TIhGiFtngdutLo5kc5IonXCpe7FhnWFq1]--></g></svg>