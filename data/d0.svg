<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="626px" preserveAspectRatio="none" style="width:754px;height:626px;background:#000000;" version="1.1" viewBox="0 0 754 626" width="754px" zoomAndPan="magnify"><title>Diagram 2: Direct Communication (Cert Already Installed)</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="721.499" x="15" y="37.1182">Diagram 2: Direct Communication (Cert Already Installed)</text><g><title>PeerA</title><rect fill="#87CEEB" height="256.3945" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="472.7922" y="207.3506"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="385.7925" width="8" x="264.7952" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="268.7952" x2="268.7952" y1="131.752" y2="517.5444"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="385.7925" width="8" x="473.7922" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="477.7922" x2="477.7922" y1="131.752" y2="517.5444"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="245.448" y="128.8125">PeerB</text><ellipse cx="268.7952" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M268.7952,89.7373 C272.7952,89.7373 275.7952,89.7373 279.7952,85.7373 C287.7952,85.7373 295.7952,93.7373 295.7952,101.7373 L295.7952,105.7373 C295.7952,109.7373 291.7952,113.7373 287.7952,113.7373 L249.7952,113.7373 C245.7952,113.7373 241.7952,109.7373 241.7952,105.7373 L241.7952,101.7373 C241.7952,93.7373 249.7952,85.7373 257.7952,85.7373 C261.7952,89.7373 264.7952,89.7373 268.7952,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="245.448" y="530.6196">PeerB</text><ellipse cx="268.7952" cy="550.5591" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M268.7952,570.5591 C272.7952,570.5591 275.7952,570.5591 279.7952,566.5591 C287.7952,566.5591 295.7952,574.5591 295.7952,582.5591 L295.7952,586.5591 C295.7952,590.5591 291.7952,594.5591 287.7952,594.5591 L249.7952,594.5591 C245.7952,594.5591 241.7952,590.5591 241.7952,586.5591 L241.7952,582.5591 C241.7952,574.5591 249.7952,566.5591 257.7952,566.5591 C261.7952,570.5591 264.7952,570.5591 268.7952,570.5591" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="454.4587" y="128.8125">PeerA</text><ellipse cx="477.7922" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M477.7922,89.7373 C481.7922,89.7373 484.7922,89.7373 488.7922,85.7373 C496.7922,85.7373 504.7922,93.7373 504.7922,101.7373 L504.7922,105.7373 C504.7922,109.7373 500.7922,113.7373 496.7922,113.7373 L458.7922,113.7373 C454.7922,113.7373 450.7922,109.7373 450.7922,105.7373 L450.7922,101.7373 C450.7922,93.7373 458.7922,85.7373 466.7922,85.7373 C470.7922,89.7373 473.7922,89.7373 477.7922,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="454.4587" y="530.6196">PeerA</text><ellipse cx="477.7922" cy="550.5591" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M477.7922,570.5591 C481.7922,570.5591 484.7922,570.5591 488.7922,566.5591 C496.7922,566.5591 504.7922,574.5591 504.7922,582.5591 L504.7922,586.5591 C504.7922,590.5591 500.7922,594.5591 496.7922,594.5591 L458.7922,594.5591 C454.7922,594.5591 450.7922,590.5591 450.7922,586.5591 L450.7922,582.5591 C450.7922,574.5591 458.7922,566.5591 466.7922,566.5591 C470.7922,570.5591 473.7922,570.5591 477.7922,570.5591" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g><title>PeerA</title><rect fill="#87CEEB" height="256.3945" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="472.7922" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="552.9087" x="99.7952" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="99.7952" x2="652.7039" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="99.7952" x2="652.7039" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="284.9844" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="290.9844" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="460.7922,203.3506,470.7922,207.3506,460.7922,211.3506,464.7922,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="268.7952" x2="466.7922" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="275.7952" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171.7549" x="289.0374" y="202.6211">AKE_REQUEST(Kyber_CT)</text></g><path d="M486.7952,220.3506 L486.7952,261.3506 L646.7952,261.3506 L646.7952,230.3506 L636.7952,220.3506 L486.7952,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M636.7952,220.3506 L636.7952,230.3506 L646.7952,230.3506 L636.7952,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.9087" x="492.7952" y="238.4204">1. Decapsulate Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136.3477" x="492.7952" y="254.2197">2. Derive shared key</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="279.7952,284.7485,269.7952,288.7485,279.7952,292.7485,275.7952,288.7485" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="273.7952" x2="471.7922" y1="288.7485" y2="288.7485"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="285.7952" y="284.019">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="130.5459" x="299.0374" y="284.019">SESSION_CONFIRM</text></g><path d="M104.7952,301.7485 L104.7952,326.7485 L263.7952,326.7485 L263.7952,311.7485 L253.7952,301.7485 L104.7952,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M253.7952,301.7485 L253.7952,311.7485 L263.7952,311.7485 L253.7952,301.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.6328" x="110.7952" y="319.8184">Verify Initialize AEAD</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="552.9087" x="99.7952" y="353.4475"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="99.7952" x2="652.7039" y1="353.4475" y2="353.4475"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="99.7952" x2="652.7039" y1="356.4475" y2="356.4475"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="127.1216" x="312.6887" y="342.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.6782" x="318.6887" y="359.6177">Data Exchange</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="460.7922,394.1465,470.7922,398.1465,460.7922,402.1465,464.7922,398.1465" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="268.7952" x2="466.7922" y1="398.1465" y2="398.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="275.7952" y="393.417">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.4541" x="289.0374" y="393.417">ENC_PAYLOAD[0]</text></g><path d="M273.7952,411.1465 L273.7952,436.1465 L426.7952,436.1465 L426.7952,421.1465 L416.7952,411.1465 L273.7952,411.1465" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M416.7952,411.1465 L416.7952,421.1465 L426.7952,421.1465 L416.7952,411.1465" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="279.7952" y="429.2163">ChaCha20-Poly1305</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="279.7952,459.7451,269.7952,463.7451,279.7952,467.7451,275.7952,463.7451" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="273.7952" x2="476.7922" y1="463.7451" y2="463.7451"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="285.7952" y="459.0156">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.4072" x="299.0374" y="459.0156">ENC_RESPONSE[0]</text></g><path d="M368.7952,476.7451 L368.7952,501.7451 L471.7952,501.7451 L471.7952,486.7451 L461.7952,476.7451 L368.7952,476.7451" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M461.7952,476.7451 L461.7952,486.7451 L471.7952,486.7451 L461.7952,476.7451" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.6465" x="374.7952" y="494.8149">Rate limiting</text><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="3.5156" x="373.9917" y="611.6128">&#160;</text><!--SRC=[VLFlRzem4Ftkl-9A9wtzq8bssezMOb8Ip5ILGaROfAgha4aEi71ivZZTMBN_VUS0NTAEdl8XkVVktJkVS-0Mc2Eib92QiTVmMPcfK909kuGAOiLIwfMm8eUfI9TpQqgTHKOP2uVjAcgC36UYLAvdjDjIUbLuvO5nMDIuchxXWOLFHRSLeR4PscQZckusyySh1wapjYujV29nQuKWVc9X6bDK83LE75eqRht2vtQVPwf62VueKQS81MbBFQ-f5ZleWVNb3FjIOsE2hSmZjkSeOs6TJELAQFU_ygwybvJSLxs3zrVk6QnA5UpWLSpvQ19Cec5_E0AA3hGEFtw8E0zREpHiehrU-3uwzUXra8m9hqWRYiVFsvoVjpsUt11-_RJQHuknpLPQCPBz5eW2uX0Q_UgCOCC8eE6NCISThRmhnTolvEo2NYscZiRByrBBL3XfD1n5Q1q4ogB8rd2f2oUKmkoOJ9JEw3AVecMiqw5r5uKluCIOAbaiSjGEEXr6tavk6-xkFf6T2mYk-6J4ltpboVZeQaqwasXyx9tBUq6t_PdZwX-mShvmLVdf6-XYAbP5gJozKlYkptpModkwTWjXCOCbhXaZhPs7u9-7y08IdYINmm7b1htBqVMcXyAPgz1lf3JpKqidXPA_4G8UTAjnky89uB_IXT1pV75CFeWcSN3J7mRTs_PTOmfg4Iq4FMVjazYezUdRzhiNp7gb4K_YuI3XZr8RizHdv4z1oPoyqi_6CgoT96CpGsIw4Qs_]--></g></svg>