<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="710px" preserveAspectRatio="none" style="width:555px;height:710px;background:#000000;" version="1.1" viewBox="0 0 555 710" width="555px" zoomAndPan="magnify"><title>Case 2: Peer-to-Peer Communication Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="522.5322" x="15" y="37.1182">Case 2: Peer-to-Peer Communication Flow</text><g><title>PeerA</title><rect fill="#87CEEB" height="375.5918" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="162.6499" y="207.3506"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="469.1904" width="8" x="163.6499" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="167.6499" x2="167.6499" y1="131.752" y2="600.9424"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="469.1904" width="8" x="332.2993" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="336.2993" x2="336.2993" y1="131.752" y2="600.9424"/></g><g><title>Bridge channel</title><rect fill="#000000" fill-opacity="0.00000" height="469.1904" width="8" x="432.5908" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="436.2993" x2="436.2993" y1="131.752" y2="600.9424"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="144.3164" y="128.8125">PeerA</text><ellipse cx="167.6499" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M167.6499,89.7373 C171.6499,89.7373 174.6499,89.7373 178.6499,85.7373 C186.6499,85.7373 194.6499,93.7373 194.6499,101.7373 L194.6499,105.7373 C194.6499,109.7373 190.6499,113.7373 186.6499,113.7373 L148.6499,113.7373 C144.6499,113.7373 140.6499,109.7373 140.6499,105.7373 L140.6499,101.7373 C140.6499,93.7373 148.6499,85.7373 156.6499,85.7373 C160.6499,89.7373 163.6499,89.7373 167.6499,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="144.3164" y="614.0176">PeerA</text><ellipse cx="167.6499" cy="633.957" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M167.6499,653.957 C171.6499,653.957 174.6499,653.957 178.6499,649.957 C186.6499,649.957 194.6499,657.957 194.6499,665.957 L194.6499,669.957 C194.6499,673.957 190.6499,677.957 186.6499,677.957 L148.6499,677.957 C144.6499,677.957 140.6499,673.957 140.6499,669.957 L140.6499,665.957 C140.6499,657.957 148.6499,649.957 156.6499,649.957 C160.6499,653.957 163.6499,653.957 167.6499,653.957" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="312.9521" y="128.8125">PeerB</text><ellipse cx="336.2993" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M336.2993,89.7373 C340.2993,89.7373 343.2993,89.7373 347.2993,85.7373 C355.2993,85.7373 363.2993,93.7373 363.2993,101.7373 L363.2993,105.7373 C363.2993,109.7373 359.2993,113.7373 355.2993,113.7373 L317.2993,113.7373 C313.2993,113.7373 309.2993,109.7373 309.2993,105.7373 L309.2993,101.7373 C309.2993,93.7373 317.2993,85.7373 325.2993,85.7373 C329.2993,89.7373 332.2993,89.7373 336.2993,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="312.9521" y="614.0176">PeerB</text><ellipse cx="336.2993" cy="633.957" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M336.2993,653.957 C340.2993,653.957 343.2993,653.957 347.2993,649.957 C355.2993,649.957 363.2993,657.957 363.2993,665.957 L363.2993,669.957 C363.2993,673.957 359.2993,677.957 355.2993,677.957 L317.2993,677.957 C313.2993,677.957 309.2993,673.957 309.2993,669.957 L309.2993,665.957 C309.2993,657.957 317.2993,649.957 325.2993,649.957 C329.2993,653.957 332.2993,653.957 336.2993,653.957" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="SC"><path d="M379.2993,104.7373 L493.8823,104.7373 C498.8823,104.7373 498.8823,118.2446 498.8823,118.2446 C498.8823,118.2446 498.8823,131.752 493.8823,131.752 L379.2993,131.752 C374.2993,131.752 374.2993,118.2446 374.2993,118.2446 C374.2993,118.2446 374.2993,104.7373 379.2993,104.7373" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M493.8823,104.7373 C488.8823,104.7373 488.8823,118.2446 488.8823,118.2446 C488.8823,131.752 493.8823,131.752 493.8823,131.752" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="379.2993" y="123.8125">Bridge channel</text></g><g class="participant participant-tail" data-participant="SC"><path d="M379.2993,599.9424 L493.8823,599.9424 C498.8823,599.9424 498.8823,613.4497 498.8823,613.4497 C498.8823,613.4497 498.8823,626.957 493.8823,626.957 L379.2993,626.957 C374.2993,626.957 374.2993,613.4497 374.2993,613.4497 C374.2993,613.4497 374.2993,599.9424 379.2993,599.9424" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M493.8823,599.9424 C488.8823,599.9424 488.8823,613.4497 488.8823,613.4497 C488.8823,626.957 493.8823,626.957 493.8823,626.957" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="379.2993" y="619.0176">Bridge channel</text></g><g><title>PeerA</title><rect fill="#87CEEB" height="375.5918" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="162.6499" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="185.501" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="191.501" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="183.6499,203.3506,173.6499,207.3506,183.6499,211.3506,179.6499,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="177.6499" x2="335.2993" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="189.6499" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.6079" x="202.8921" y="202.6211">Kyber Ciphertext</text></g><path d="M177.6499,220.3506 L177.6499,245.3506 L341.6499,245.3506 L341.6499,230.3506 L331.6499,220.3506 L177.6499,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M331.6499,220.3506 L331.6499,230.3506 L341.6499,230.3506 L331.6499,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.6348" x="183.6499" y="238.4204">1. Decapsulate Secret</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="324.2993,268.9492,334.2993,272.9492,324.2993,276.9492,328.2993,272.9492" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="172.6499" x2="330.2993" y1="272.9492" y2="272.9492"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="179.6499" y="268.2197">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105.9551" x="192.8921" y="268.2197">Session Confirm</text></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="301.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="301.8489" y2="301.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="304.8489" y2="304.8489"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="127.1216" x="213.2053" y="290.9492"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.6782" x="219.2053" y="308.019">Data Exchange</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="183.6499,342.5479,173.6499,346.5479,183.6499,350.5479,179.6499,346.5479" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="177.6499" x2="335.2993" y1="346.5479" y2="346.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="189.6499" y="341.8184">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.3184" x="202.8921" y="341.8184">AUTH_DATA[0]</text></g><path d="M340.6499,359.5479 L340.6499,400.5479 L493.6499,400.5479 L493.6499,369.5479 L483.6499,359.5479 L340.6499,359.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M483.6499,359.5479 L483.6499,369.5479 L493.6499,369.5479 L483.6499,359.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="346.6499" y="377.6177">ChaCha20-Poly1305</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="59.998" x="346.6499" y="393.417">Seq: 001</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="324.2993,423.9458,334.2993,427.9458,324.2993,431.9458,328.2993,427.9458" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="172.6499" x2="330.2993" y1="427.9458" y2="427.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="179.6499" y="423.2163">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.4072" x="192.8921" y="423.2163">ENC_RESPONSE[0]</text></g><path d="M54.6499,440.9458 L54.6499,481.9458 L157.6499,481.9458 L157.6499,450.9458 L147.6499,440.9458 L54.6499,440.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M147.6499,440.9458 L147.6499,450.9458 L157.6499,450.9458 L147.6499,440.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2656" x="60.6499" y="459.0156">Rate Limited</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="75.6577" x="60.6499" y="474.8149">Anti-Replay</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="454.2324" x="49.6499" y="508.4441"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="508.4441" y2="508.4441"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="49.6499" x2="503.8823" y1="511.4441" y2="511.4441"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="174.5894" x="189.4714" y="497.5444"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.146" x="195.4714" y="514.6143">Channel Maintenance</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="424.5908,549.1431,434.5908,553.1431,424.5908,557.1431,428.5908,553.1431" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="336.2993" x2="430.5908" y1="553.1431" y2="553.1431"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="343.2993" y="548.4136">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9751" x="356.5415" y="548.4136">Keepalive</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="178.6499,578.9424,168.6499,582.9424,178.6499,586.9424,174.6499,582.9424" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="172.6499" x2="435.5908" y1="582.9424" y2="582.9424"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="184.6499" y="578.2129">6</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.7651" x="197.8921" y="578.2129">Heartbeat</text></g><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="249.4434" x="151.5444" y="695.0107">Secure Messaging Protocol v1.4 | IETF-Compliant</text><!--SRC=[xLXjSzf64FwkNt4XcMdo0HVis4cO95CXX5y2DaKuRIR9P0xfWAl5dNewOTFK_xrxUZ6ICGB9rDEaqTY9HzfdR_UvtRszHMZ5yqXEo9GWpyMKQTegAVGJEdJv4Bl8mU82HHYVI4dPs5-DyYyeyx30KpJ4ziLOy80v1dUvG8zhuRC9r24Z7BYopPcCiUtmoRNsb4imq2Cs7L6xaALC8R-kbbHFyxOtiKNv82uS8ZPqNpqfZzU9N-UIeTiIb2onWQeeyE4FDEMCsnF1rPxAkKiseGahdPQIHlYI-83T6BMENKiIGRYSUsHvppSbR9ruFc46A1BSBHT0TWp-kZLZ4t6B_aLG_KMns7pIrQs1sV_IC-4VuwnprjyyJ8jYBHkxv7TKtzdVGEv3lbp-3lqQaA1aWlyPGl_r32yOiFVBS8k0LyoEyXU8s8G7Fy6ieQ93HwH36IditGsmQErNJmyBIMtgOIOBBtm8YtcbLesGt9dV1rt6seBLe4Ld55OfPMM2BMfdZDjYaGKblZhUAQEIShPQ-D6Ji0BfKGr2Rr3bySiNXcasAtcOfU8L0b_LJFDLhR9siMOAqsut3unwBiRw08jrCnZrv1jeTi_w7ufXcltZrg6Pmen6QiihkLIdaYcdH4Q7SwL7YD0h2FkefwCCyHj1cn6qYJ8qheP6vRZI5DGP4sHFC6F43NLO1iguc-EYf18Q4GFx1Eqsa3AZAdbL_GzXDfq6ZDfOXHXgk_moHmyE96V1T4Z4QfatRw3S-hxIPleI3rtgJwQ4IVYGena8gNxCKFBvBH3SGE_cGsKbzIP4I78bSqccCmpTwURx4ZQpWeudCbohleDQnCQU7xXAZqLiGMIUqVgDqVh2w6RZXW1eb4PKJ3KjbwuMbXYPLsflOOlBqQIV3uw-jFI1_h7sUJD_mKnZWk5djrRjSNTUtwljVs9mKZPGhLOluxLvQdpfcrRlxDGorvlXab74UbzntQ5JAedpYUbCqcgVm8Lhdi-Q4QK2wiBDJ1A6rL5Td3lBW10ZnCCkdUMqw91hW4rdMypx4O7QCIGuBqmSaWhD7BaH1rwWJ43S1OAWBWGH7giBI4zmoMtecMVrdUVeRtHi3jfLI5pFfL2oSkhXBuGvmTJLakTrU7zv2m01QyMTpUrJyd82Ew5b-w-X2q8txqunN8NU4-5WXiENHt0P4T3BN2JIGQH0jJUt5QXtWmcrBnZuX-hXkouMu2XIxUur_3hS3iAI4Ha86HaMfwGHosg8ZlDhBSNWUi49mSv6Wb7bJEHkRXcxkskGwfTn9u5syHMT1jFVg2CdQ2ziGQwrrp_7sw4jkavT27xPuQvBFUwbgLk8tBrVY- -jnK0Wir5B4bsur_eUjebp8slmG52exWjPrQL2oqmiAI20ntFmokSkTL8YgUEpXnr7HMozblgUTDztTSgtdRCcsE6NIiK8ktxQhNEVD8d4qPrQ2eYmD6qgmQYSXtIl2kWc5jbWN3RahfXV8l8wlHbg6IoYXMzZiu9NeKp2q7xcgq65xH87Qfg0MX57PeufoJuXg9uE3NpqAglEnH2DkLpSt_Lm4LrAGOT1F1Cges4npYYZeht8-8B8eqK9A8fKrGvouY84fqfUMkZOvgm7ol2OPCJYoBjpMvRm8ZerokE170Wdfxo60FetknJyb9SBYhFX7s1p5BnBGNgTAJiBThSGpfPCgDuyPxBu98xrhMWnjgB5t8gMuwreERs75gZ-wleIAHiKAXR_lVdxTpnD_rzCm7yCinzmcFqzJwP_J9j_J9iVSDfSRBOPpv2BJJNZMN39UMOyhVts9van3VUQOQxbVnlJotYH1vbRPabvw8bbrjDlOLQvuAl8b3BEeMzhFjbpGV2ysq4p8i88hE_irdRtTtQV3g1Qd626QYzG_MLZRx-nTu0CSu3KvsVQqyDU1_ay442eG_re5W7uPze9dc7K3s27fgI1pZp2JbhlaXV8P3CgE5FPh9syxou43fvNcrH28WYm1BtlQl6i310sLuER1Ze7vrvg7GZw0AwV3KIOPa3Lbs8Etwn_0000]--></g></svg>