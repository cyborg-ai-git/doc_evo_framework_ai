<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="691px" preserveAspectRatio="none" style="width:751px;height:691px;background:#000000;" version="1.1" viewBox="0 0 751 691" width="751px" zoomAndPan="magnify"><title>PeerB get_peer PeerA certificate from Master Peer</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="626.8711" x="60.6782" y="37.1182">PeerB get_peer PeerA certificate from Master Peer</text><g><title>MasterPeer</title><rect fill="#90EE90" height="330.7925" style="stroke:#000000;stroke-width:1;" width="10" x="459.0527" y="207.3506"/></g><g><title>CertDB</title><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1;" width="10" x="626.9194" y="288.7485"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="475.9897" width="8" x="271" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="275" x2="275" y1="131.752" y2="607.7417"/></g><g><title>MasterPeer</title><rect fill="#000000" fill-opacity="0.00000" height="475.9897" width="8" x="460.0527" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="463.8384" x2="463.8384" y1="131.752" y2="607.7417"/></g><g><title>CertDB</title><rect fill="#000000" fill-opacity="0.00000" height="475.9897" width="8" x="627.9194" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="630.9238" x2="630.9238" y1="131.752" y2="607.7417"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="251.6528" y="128.8125">PeerB</text><ellipse cx="275" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M275,89.7373 C279,89.7373 282,89.7373 286,85.7373 C294,85.7373 302,93.7373 302,101.7373 L302,105.7373 C302,109.7373 298,113.7373 294,113.7373 L256,113.7373 C252,113.7373 248,109.7373 248,105.7373 L248,101.7373 C248,93.7373 256,85.7373 264,85.7373 C268,89.7373 271,89.7373 275,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="251.6528" y="620.8169">PeerB</text><ellipse cx="275" cy="640.7563" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M275,660.7563 C279,660.7563 282,660.7563 286,656.7563 C294,656.7563 302,664.7563 302,672.7563 L302,676.7563 C302,680.7563 298,684.7563 294,684.7563 L256,684.7563 C252,684.7563 248,680.7563 248,676.7563 L248,672.7563 C248,664.7563 256,656.7563 264,656.7563 C268,660.7563 271,660.7563 275,660.7563" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="421.8384" y="128.8125">MasterPeer</text><ellipse cx="464.0527" cy="69.7373" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M464.0527,89.7373 C468.0527,89.7373 471.0527,89.7373 475.0527,85.7373 C483.0527,85.7373 491.0527,93.7373 491.0527,101.7373 L491.0527,105.7373 C491.0527,109.7373 487.0527,113.7373 483.0527,113.7373 L445.0527,113.7373 C441.0527,113.7373 437.0527,109.7373 437.0527,105.7373 L437.0527,101.7373 C437.0527,93.7373 445.0527,85.7373 453.0527,85.7373 C457.0527,89.7373 460.0527,89.7373 464.0527,89.7373" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="421.8384" y="620.8169">MasterPeer</text><ellipse cx="464.0527" cy="640.7563" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M464.0527,660.7563 C468.0527,660.7563 471.0527,660.7563 475.0527,656.7563 C483.0527,656.7563 491.0527,664.7563 491.0527,672.7563 L491.0527,676.7563 C491.0527,680.7563 487.0527,684.7563 483.0527,684.7563 L445.0527,684.7563 C441.0527,684.7563 437.0527,680.7563 437.0527,676.7563 L437.0527,672.7563 C437.0527,664.7563 445.0527,656.7563 453.0527,656.7563 C457.0527,660.7563 460.0527,660.7563 464.0527,660.7563" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="603.9238" y="128.8125">CertDB</text><path d="M613.9194,78.7373 C613.9194,68.7373 631.9194,68.7373 631.9194,68.7373 C631.9194,68.7373 649.9194,68.7373 649.9194,78.7373 L649.9194,104.7373 C649.9194,114.7373 631.9194,114.7373 631.9194,114.7373 C631.9194,114.7373 613.9194,114.7373 613.9194,104.7373 L613.9194,78.7373" fill="#FBFF00" style="stroke:#000000;stroke-width:1;"/><path d="M613.9194,78.7373 C613.9194,88.7373 631.9194,88.7373 631.9194,88.7373 C631.9194,88.7373 649.9194,88.7373 649.9194,78.7373" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="603.9238" y="620.8169">CertDB</text><path d="M613.9194,633.7563 C613.9194,623.7563 631.9194,623.7563 631.9194,623.7563 C631.9194,623.7563 649.9194,623.7563 649.9194,633.7563 L649.9194,659.7563 C649.9194,669.7563 631.9194,669.7563 631.9194,669.7563 C631.9194,669.7563 613.9194,669.7563 613.9194,659.7563 L613.9194,633.7563" fill="#FBFF00" style="stroke:#000000;stroke-width:1;"/><path d="M613.9194,633.7563 C613.9194,643.7563 631.9194,643.7563 631.9194,643.7563 C631.9194,643.7563 649.9194,643.7563 649.9194,633.7563" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g><title>MasterPeer</title><rect fill="#90EE90" height="330.7925" style="stroke:#000000;stroke-width:1;" width="10" x="459.0527" y="207.3506"/></g><g><title>CertDB</title><rect fill="#FFFFFF" height="29.7993" style="stroke:#000000;stroke-width:1;" width="10" x="626.9194" y="288.7485"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="739.2275" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="744.2275" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="744.2275" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="150.7095" x="299.259" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.2661" x="305.259" y="168.8218">Request Initiation</text><g class="message" data-participant-1="PB" data-participant-2="MP"><polygon fill="#FFB6C1" points="447.0527,203.3506,457.0527,207.3506,447.0527,211.3506,451.0527,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="275" x2="453.0527" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="282" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.8105" x="295.2422" y="202.6211">EApiEvent(ID_PEER_A)</text></g><path d="M474,220.3506 L474,261.3506 L638,261.3506 L638,230.3506 L628,220.3506 L474,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M628,220.3506 L628,230.3506 L638,230.3506 L628,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.9087" x="480" y="238.4204">1. Decapsulate Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.3237" x="480" y="254.2197">2. Derive Session Key</text><g class="message" data-participant-1="MP" data-participant-2="DB"><polygon fill="#90EE90" points="614.9194,284.7485,624.9194,288.7485,614.9194,292.7485,618.9194,288.7485" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="469.0527" x2="620.9194" y1="288.7485" y2="288.7485"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="476.0527" y="284.019">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.3691" x="489.2949" y="284.019">GET_CERT(ID_A)</text></g><g class="message" data-participant-1="DB" data-participant-2="MP"><polygon fill="#FFFFFF" points="480.0527,314.5479,470.0527,318.5479,480.0527,322.5479,476.0527,318.5479" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:2,2;" x1="474.0527" x2="630.9194" y1="318.5479" y2="318.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="486.0527" y="313.8184">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.8164" x="499.2949" y="313.8184">Cert Data</text></g><path d="M636,331.5479 L636,388.5479 L739,388.5479 L739,341.5479 L729,331.5479 L636,331.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M729,331.5479 L729,341.5479 L739,341.5479 L729,331.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="43.9131" x="642" y="349.6177">Verify:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="58.7856" x="642" y="365.417">- Validity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2275" x="642" y="381.2163">- Revocation</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="739.2275" x="5" y="414.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="744.2275" y1="414.8455" y2="414.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="744.2275" y1="417.8455" y2="417.8455"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="133.0757" x="308.0759" y="403.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.6323" x="314.0759" y="421.0156">Secure Delivery</text><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#90EE90;stroke-width:1;" x1="469.0527" x2="511.0527" y1="459.5444" y2="459.5444"/><line style="stroke:#90EE90;stroke-width:1;" x1="511.0527" x2="511.0527" y1="459.5444" y2="472.5444"/><line style="stroke:#90EE90;stroke-width:1;" x1="470.0527" x2="511.0527" y1="472.5444" y2="472.5444"/><polygon fill="#90EE90" points="480.0527,468.5444,470.0527,472.5444,480.0527,476.5444,476.0527,472.5444" style="stroke:#90EE90;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="476.0527" y="454.8149">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.6245" x="489.2949" y="454.8149">Package Response</text></g><path d="M300,485.5444 L300,510.5444 L453,510.5444 L453,495.5444 L443,485.5444 L300,485.5444" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M443,485.5444 L443,495.5444 L453,495.5444 L443,485.5444" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="306" y="503.6143">ChaCha20-Poly1305</text><g class="message" data-participant-1="MP" data-participant-2="PB"><polygon fill="#90EE90" points="286,534.1431,276,538.1431,286,542.1431,282,538.1431" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="280" x2="463.0527" y1="538.1431" y2="538.1431"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="292" y="533.4136">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="69.6338" x="305.2422" y="533.4136">ENC_CERT</text></g><path d="M10,551.1431 L10,592.1431 L270,592.1431 L270,561.1431 L260,551.1431 L10,551.1431" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M260,551.1431 L260,561.1431 L270,561.1431 L260,551.1431" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135.4209" x="16" y="569.2129">1. Decrypt Response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="239.9922" x="16" y="585.0122">2. Verify Master Peer Certificate sign</text><!--SRC=[bLHjQzim4FwkNt7B2jiOAKd7Nbh8877SKjQqNbBAoZQ2OfyJKKVoB3d3A_llEybEfpOlR2O4-rwUU-wvavwP1IuHyemBoTWBEClKZ6UGyE8EQfT6OuISQwRlXCnvmPSmu_7Tl52bJ0ALgGAUTzpZHIIOyZ8pfqgQ9kJKFRR4fJA4ccCiKX5lWvSsu9u1FOEdbHeOvrD5WiLZ1jRk5MsilstPVcp8j54Nsb1gUe6baYfU5CgsRAeCFKBSfawi4VXFr1JorDdGdHWiK9agnytEdr1hh8vQGEP2PNj5YPkO-nr0Q-j4_4Belj-gti6eFxaEnzCefB_Wwk9gl27aZf19p3Fy0jt3jty_RzsdQ-1pYUN-cVvm4VyvrEtA-KErGx73I-reaOh86FsoQrjJ-KAaU24axghouD-nu3OcueKHiSYvDBjWpYWrtuTH1wYa-eUWFIMsRy5Gh0Jbx8DUX-m0RzmxjvLCsXvn8OKHIi9Bdecvn0H-2hDuq7oQ23wd8KmxXtcvpE0rH4WrQPCf_nLxTk1sh5zl6VIWzVp3-o0C1oroRMoXynztml2uqrgd3ZpNwUdWNT1rgU7eQdphkT9PcdPSrkIMK4UFikpJibrvOzMiFjCjnxS5N4CqW4Srrn4Zhkd8spWNDegs7Q246pxZ6g4LO666DUAG47sgZ1bXw8AfDPgZcURqvZxx45EUFLcSBiQKhYYewpelOxmqIfRB6RttUZ2syci3vtOutCsdrsECEcX_VTJ3zu_4zmJ2VYx25KhpydnOi-w_iks9bQsslIDtGnTYlZ0Eedi8GunvhilCvdogYCetUMIjXLWXJ51ho-CJLemH8X7Pm2Gsmy49d8NNqo0SNrioFWyhbpy-HeOsuVYsfY4hCWn9Sv-cnRuXDcbryassuOOsDX6cikzZNAdO2SKIz0eog-O4uxAWByoeaQ9oKkxkm9QFwDpnEHAipfNKMBF8CAsr2XQSVaUTTgIoglkcytOVNaIimyl0AUBXM7EjUL7bvg6IaxnkqbyG9yXwUpGTLERtEOhO7m00]--></g></svg>