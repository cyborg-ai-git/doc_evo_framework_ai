<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="732px" preserveAspectRatio="none" style="width:693px;height:732px;background:#000000;" version="1.1" viewBox="0 0 693 732" width="693px" zoomAndPan="magnify"><title>Diagram 0: PeerA Registration Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="442.9219" x="123.7769" y="37.1182">Diagram 0: PeerA Registration Flow</text><g><title>MasterPeer</title><rect fill="#90EE90" height="346.5918" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="387.1489" y="207.3506"/></g><g><title>CertDB</title><rect fill="#FFFFFF" height="112.9966" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="565.6226" y="367.3472"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="491.7891" width="8" x="203" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="207" x2="207" y1="131.752" y2="623.541"/></g><g><title>MasterPeer</title><rect fill="#000000" fill-opacity="0.00000" height="491.7891" width="8" x="388.1489" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="391.9346" x2="391.9346" y1="131.752" y2="623.541"/></g><g><title>CertDB</title><rect fill="#000000" fill-opacity="0.00000" height="491.7891" width="8" x="566.6226" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="569.627" x2="569.627" y1="131.752" y2="623.541"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="183.6665" y="128.8125">PeerA</text><ellipse cx="207" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M207,89.7373 C211,89.7373 214,89.7373 218,85.7373 C226,85.7373 234,93.7373 234,101.7373 L234,105.7373 C234,109.7373 230,113.7373 226,113.7373 L188,113.7373 C184,113.7373 180,109.7373 180,105.7373 L180,101.7373 C180,93.7373 188,85.7373 196,85.7373 C200,89.7373 203,89.7373 207,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="183.6665" y="636.6162">PeerA</text><ellipse cx="207" cy="656.5557" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M207,676.5557 C211,676.5557 214,676.5557 218,672.5557 C226,672.5557 234,680.5557 234,688.5557 L234,692.5557 C234,696.5557 230,700.5557 226,700.5557 L188,700.5557 C184,700.5557 180,696.5557 180,692.5557 L180,688.5557 C180,680.5557 188,672.5557 196,672.5557 C200,676.5557 203,676.5557 207,676.5557" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="349.9346" y="128.8125">MasterPeer</text><ellipse cx="392.1489" cy="69.7373" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M392.1489,89.7373 C396.1489,89.7373 399.1489,89.7373 403.1489,85.7373 C411.1489,85.7373 419.1489,93.7373 419.1489,101.7373 L419.1489,105.7373 C419.1489,109.7373 415.1489,113.7373 411.1489,113.7373 L373.1489,113.7373 C369.1489,113.7373 365.1489,109.7373 365.1489,105.7373 L365.1489,101.7373 C365.1489,93.7373 373.1489,85.7373 381.1489,85.7373 C385.1489,89.7373 388.1489,89.7373 392.1489,89.7373" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="MP"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="78.4287" x="349.9346" y="636.6162">MasterPeer</text><ellipse cx="392.1489" cy="656.5557" fill="#90EE90" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M392.1489,676.5557 C396.1489,676.5557 399.1489,676.5557 403.1489,672.5557 C411.1489,672.5557 419.1489,680.5557 419.1489,688.5557 L419.1489,692.5557 C419.1489,696.5557 415.1489,700.5557 411.1489,700.5557 L373.1489,700.5557 C369.1489,700.5557 365.1489,696.5557 365.1489,692.5557 L365.1489,688.5557 C365.1489,680.5557 373.1489,672.5557 381.1489,672.5557 C385.1489,676.5557 388.1489,676.5557 392.1489,676.5557" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="542.627" y="128.8125">CertDB</text><path d="M552.6226,78.7373 C552.6226,68.7373 570.6226,68.7373 570.6226,68.7373 C570.6226,68.7373 588.6226,68.7373 588.6226,78.7373 L588.6226,104.7373 C588.6226,114.7373 570.6226,114.7373 570.6226,114.7373 C570.6226,114.7373 552.6226,114.7373 552.6226,104.7373 L552.6226,78.7373" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M552.6226,78.7373 C552.6226,88.7373 570.6226,88.7373 570.6226,88.7373 C570.6226,88.7373 588.6226,88.7373 588.6226,78.7373" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49.9912" x="542.627" y="636.6162">CertDB</text><path d="M552.6226,649.5557 C552.6226,639.5557 570.6226,639.5557 570.6226,639.5557 C570.6226,639.5557 588.6226,639.5557 588.6226,649.5557 L588.6226,675.5557 C588.6226,685.5557 570.6226,685.5557 570.6226,685.5557 C570.6226,685.5557 552.6226,685.5557 552.6226,675.5557 L552.6226,649.5557" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M552.6226,649.5557 C552.6226,659.5557 570.6226,659.5557 570.6226,659.5557 C570.6226,659.5557 588.6226,659.5557 588.6226,649.5557" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g><title>MasterPeer</title><rect fill="#90EE90" height="346.5918" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="387.1489" y="207.3506"/></g><g><title>CertDB</title><rect fill="#FFFFFF" height="112.9966" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="565.6226" y="367.3472"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="681.4756" x="5" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="686.4756" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="686.4756" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="132.1045" x="279.6855" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113.6611" x="285.6855" y="168.8218">PK Registration</text><g class="message" data-participant-1="PA" data-participant-2="MP"><polygon fill="#87CEEB" points="375.1489,203.3506,385.1489,207.3506,375.1489,211.3506,379.1489,207.3506" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="207" x2="381.1489" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="214" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.9067" x="227.2422" y="202.6211">EDATA(PK_REGISTER)</text></g><path d="M402,220.3506 L402,261.3506 L580,261.3506 L580,230.3506 L570,220.3506 L402,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M570,220.3506 L570,230.3506 L580,230.3506 L570,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.3491" x="408" y="238.4204">1. Decrypt with Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.0728" x="408" y="254.2197">2. Verify HMAC-SHA384</text><g class="message" data-participant-1="MP" data-participant-2="MP"><line style="stroke:#90EE90;stroke-width:1;" x1="397.1489" x2="439.1489" y1="288.7485" y2="288.7485"/><line style="stroke:#90EE90;stroke-width:1;" x1="439.1489" x2="439.1489" y1="288.7485" y2="301.7485"/><line style="stroke:#90EE90;stroke-width:1;" x1="398.1489" x2="439.1489" y1="301.7485" y2="301.7485"/><polygon fill="#90EE90" points="408.1489,297.7485,398.1489,301.7485,408.1489,305.7485,404.1489,301.7485" style="stroke:#90EE90;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="404.1489" y="284.019">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131.2314" x="417.3911" y="284.019">Generate Certificate</text></g><path d="M234,314.7485 L234,339.7485 L381,339.7485 L381,324.7485 L371,314.7485 L234,314.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M371,314.7485 L371,324.7485 L381,324.7485 L371,314.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.3057" x="240" y="332.8184">Dilithium Signature</text><g class="message" data-participant-1="MP" data-participant-2="DB"><polygon fill="#90EE90" points="553.6226,363.3472,563.6226,367.3472,553.6226,371.3472,557.6226,367.3472" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="397.1489" x2="559.6226" y1="367.3472" y2="367.3472"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="404.1489" y="362.6177">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.4287" x="417.3911" y="362.6177">Store(ID_A, Cert)</text></g><path d="M580,380.3472 L580,453.3472 L681,453.3472 L681,390.3472 L671,380.3472 L580,380.3472" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M671,380.3472 L671,390.3472 L681,390.3472 L671,380.3472" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="67.1011" x="586" y="398.417">Structure:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.562" x="586" y="414.2163">- Public Key</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70.9414" x="586" y="430.0156">- Metadata</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80.4756" x="586" y="445.8149">- Signatures</text><g class="message" data-participant-1="DB" data-participant-2="MP"><polygon fill="#FFFFFF" points="408.1489,476.3438,398.1489,480.3438,408.1489,484.3438,404.1489,480.3438" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="402.1489" x2="569.6226" y1="480.3438" y2="480.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="414.1489" y="475.6143">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.6401" x="427.3911" y="475.6143">Storage ACK</text></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="681.4756" x="5" y="509.2434"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="686.4756" y1="509.2434" y2="509.2434"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="686.4756" y1="512.2434" y2="512.2434"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="158.8916" x="266.292" y="498.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.4482" x="272.292" y="515.4136">Certificate Delivery</text><g class="message" data-participant-1="MP" data-participant-2="PA"><polygon fill="#90EE90" points="218,549.9424,208,553.9424,218,557.9424,214,553.9424" style="stroke:#90EE90;stroke-width:1;"/><line style="stroke:#90EE90;stroke-width:1;" x1="212" x2="391.1489" y1="553.9424" y2="553.9424"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="224" y="549.2129">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.8267" x="237.2422" y="549.2129">Cert Package</text></g><path d="M10,566.9424 L10,607.9424 L202,607.9424 L202,576.9424 L192,566.9424 L10,566.9424" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M192,566.9424 L192,576.9424 L202,576.9424 L192,566.9424" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171.8945" x="16" y="585.0122">1. Verify Master Signature</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.5088" x="16" y="600.8115">2. Store Securely</text><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="260.5127" x="214.9814" y="717.6094">Certificate Issuance Protocol v2.1 | NIST-Compliant</text><!--SRC=[xLZxRzis4FxTVyNL7R04c3FRQThKQ8h9ZpojHB3T3iKw1BH4svnbqgEefDwM_tr7FI8fZkH7KwmhAY10BDrtlFlkU4SUmEFFCpMXCmfpbp1UAkK8mOzmueeXSS4XSWeXnADACJxsSa7UbF4vaMG6Gs9FnrBut6a9LqXuNWsUDP0E7H7VLSU2gmXw73n5fbuAXTRDgSr6pDx4JAw1V-SAwgVvq9F8d4ACa0wLwtckdvIpAwJlYcWmR8Kgjk61Q6HVBLmAv9PwOaRN1QrWhw-ef48jvdGve6ioiaAwa94-_TEdtCRaGD-GYpMyyc98iMDTDg9Tncacr6iuTe_RS8Feno9ICPlD2LURBjjcDmm1swmQGxTRyOa26QZmT75Wd2acUAxiin-iJgTtRLothhfNFJY2ylF3LwrEfrakW9X6Vu2W09dWNbSxdTVLGbp7lEfzI456mz6eMWZfVy2bp1GafALSv7qgyFcxEToEPOjIQPI1U60PaE5Y5T8a7kvMZG_WfWNBlEJgS8WYG-9HABUeLErceABTX0n5-Jugfh3sj1aPwprORK3W1lJec7bA4XrnE7R5RRu6uYl1_TcGodoPeoEmBh9AZuvofP6_ocyP1dz_YwmqeDCs1iQETN7TwvoSQO9sYwXbDmIRp6Pi1dr9il541GlMzg1DRRcOAxXbQW8N2tJp8w_lmNigsMW1fwRHglHFZVt35_dUemdepv8HaLCdb5EfBTNnq_q3_o-spwMZqBmsSz4gvi-WpyQSA5_IRQneDnlOBuIaEsVjQ-Edm90rcDL9bjvKwv0QBYLzMzlQ-CWhOFb35tlc1LteNoPLH6Uq_l_Uf_ojXoPKqAcq5H6hsXyofc2qBlAt3atvKfYygT1WGhZiXif5KGRdSsqPZK0RbXPxYWQk4MaDgTrdN5Wi4dA2R0oYXqtNnXVkOXs7JIlVuP4GUeboskipp_E9xiwM54hOmeMR-buD_e5Bt8YLbfZDNOPLChy0_qAvuy_SKloyqIS3-XRb9IuNDVs7RV9smgBDaBIpeOj2z-yk2PwFaHg7S1AyFCKZZyH6Fusb_L21xlqF5UXtWmcpfvnw7jI2ToQHOyRXeAGR8r8cR7z6UMoWJUP1zOhFA5aDOJ-_AwL8N2queSHPIp0irR6SThxF_g9Ghwz0wZykd1Xgaaziviz-PGuMjFtW379NUlDp58vISY0pf1ItNU6wR2xcQUeIaSVZbNnl9tUAJA2M94p1XJSdDdNkPLl2bmoRIYAhZt1ucAHztKFeU85UUS9bJaearR0juZXuyeHQDVKzFfS-Tefyw5n_GXnngrMCYEkbtNhdqIOMgl3SZjMCPcZJMuofHK1tNa8tYSmcux8XZ-Ny4f5twM3ePOWC5tw8pGf-2cHYXWuoNrjCsYvrMXFyPSSfN61A72U07d6Oxy7hh3gNO3OMSl7vhWUB64f9DlIZY-Ks6f9BqpOgZfCTlo7oD2a1co9rjSCzCGt0gPAN5Zgp1O_QJKOiohn7mxA4bs7Vs1wFv60wETjh20yAsy0lnNP9SJNy0sqEatSfIUyoPITXzmdIkQzYgjVVCrbydCV6asXfFOcMpfDeENiIBPUVeGMhVmilNA6omKR5uYiRu7sRyxXlVRhsVMJsDOpCDXe7HPEmpGT1qIXiu-bFD0_x7yvz8ge-R-ApYhOlD-Q9LlulPZl9qjiFT5Ob_fSUvKJhVpr3d8JKxvCRoqMvTsONa3bFx-NQNhrQFzYhxmny2kU4G_KLr0uR-mUD_PVGwWn0VzujxPnONV3mceX6EBeIw5iQudTBv-I6GC_dYire0wxcb9-tB-8NqE4tJ0gkno-by_Tc8l3oHQN95B8cqH9uRvQYAG8YRA6lj0ruDpYk79QwX8zzZ5K3A2_XHPKhkS1l_Ny1]--></g></svg>