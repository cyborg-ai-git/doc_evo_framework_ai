<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="748px" preserveAspectRatio="none" style="width:882px;height:748px;background:#000000;" version="1.1" viewBox="0 0 882 748" width="882px" zoomAndPan="magnify"><title>EPQB Local P2P with Cached Memento</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="474.5146" x="202.5015" y="37.1182">EPQB Local P2P with Cached Memento</text><g><title>Local Memento</title><rect fill="#FFFFFF" height="81.3979" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="547.1245" y="208.3652"/></g><g><title>PeerB</title><rect fill="#FFB6C1" height="81.3979" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="640.9868" y="517.3584"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="519.7891" width="8" x="232" y="132.7666"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="236" x2="236" y1="132.7666" y2="652.5557"/></g><g><title>Local Memento</title><rect fill="#000000" fill-opacity="0.00000" height="519.7891" width="8" x="548.1245" y="132.7666"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="551.2622" x2="551.2622" y1="132.7666" y2="652.5557"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="519.7891" width="8" x="641.9868" y="132.7666"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="645.9868" x2="645.9868" y1="132.7666" y2="652.5557"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="212.6665" y="129.8271">PeerA</text><ellipse cx="236" cy="70.752" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M236,90.752 C240,90.752 243,90.752 247,86.752 C255,86.752 263,94.752 263,102.752 L263,106.752 C263,110.752 259,114.752 255,114.752 L217,114.752 C213,114.752 209,110.752 209,106.752 L209,102.752 C209,94.752 217,86.752 225,86.752 C229,90.752 232,90.752 236,90.752" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="212.6665" y="665.6309">PeerA</text><ellipse cx="236" cy="685.5703" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M236,705.5703 C240,705.5703 243,705.5703 247,701.5703 C255,701.5703 263,709.5703 263,717.5703 L263,721.5703 C263,725.5703 259,729.5703 255,729.5703 L217,729.5703 C213,729.5703 209,725.5703 209,721.5703 L209,717.5703 C209,709.5703 217,701.5703 225,701.5703 C229,705.5703 232,705.5703 236,705.5703" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="105.7246" x="496.2622" y="112.8125">Local Memento</text><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="55.3916" x="521.4287" y="129.8271">(Cache)</text><path d="M534.1245,62.7373 C534.1245,52.7373 552.1245,52.7373 552.1245,52.7373 C552.1245,52.7373 570.1245,52.7373 570.1245,62.7373 L570.1245,88.7373 C570.1245,98.7373 552.1245,98.7373 552.1245,98.7373 C552.1245,98.7373 534.1245,98.7373 534.1245,88.7373 L534.1245,62.7373" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M534.1245,62.7373 C534.1245,72.7373 552.1245,72.7373 552.1245,72.7373 C552.1245,72.7373 570.1245,72.7373 570.1245,62.7373" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="DB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="105.7246" x="496.2622" y="665.6309">Local Memento</text><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="55.3916" x="521.4287" y="682.6455">(Cache)</text><path d="M534.1245,695.585 C534.1245,685.585 552.1245,685.585 552.1245,685.585 C552.1245,685.585 570.1245,685.585 570.1245,695.585 L570.1245,721.585 C570.1245,731.585 552.1245,731.585 552.1245,731.585 C552.1245,731.585 534.1245,731.585 534.1245,721.585 L534.1245,695.585" fill="#FBFF00" style="stroke:#000000;stroke-width:1.5;"/><path d="M534.1245,695.585 C534.1245,705.585 552.1245,705.585 552.1245,705.585 C552.1245,705.585 570.1245,705.585 570.1245,695.585" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="622.6396" y="129.8271">PeerB</text><ellipse cx="645.9868" cy="70.752" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M645.9868,90.752 C649.9868,90.752 652.9868,90.752 656.9868,86.752 C664.9868,86.752 672.9868,94.752 672.9868,102.752 L672.9868,106.752 C672.9868,110.752 668.9868,114.752 664.9868,114.752 L626.9868,114.752 C622.9868,114.752 618.9868,110.752 618.9868,106.752 L618.9868,102.752 C618.9868,94.752 626.9868,86.752 634.9868,86.752 C638.9868,90.752 641.9868,90.752 645.9868,90.752" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="622.6396" y="665.6309">PeerB</text><ellipse cx="645.9868" cy="685.5703" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M645.9868,705.5703 C649.9868,705.5703 652.9868,705.5703 656.9868,701.5703 C664.9868,701.5703 672.9868,709.5703 672.9868,717.5703 L672.9868,721.5703 C672.9868,725.5703 668.9868,729.5703 664.9868,729.5703 L626.9868,729.5703 C622.9868,729.5703 618.9868,725.5703 618.9868,721.5703 L618.9868,717.5703 C618.9868,709.5703 626.9868,701.5703 634.9868,701.5703 C638.9868,705.5703 641.9868,705.5703 645.9868,705.5703" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g><title>Local Memento</title><rect fill="#FFFFFF" height="81.3979" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="547.1245" y="208.3652"/></g><g><title>PeerB</title><rect fill="#FFB6C1" height="81.3979" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="640.9868" y="517.3584"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="870.5176" x="5" y="163.6663"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="163.6663" y2="163.6663"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="166.6663" y2="166.6663"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="138.23" x="371.1438" y="152.7666"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119.7866" x="377.1438" y="169.8364">Discovery Phase</text><g class="message" data-participant-1="PA" data-participant-2="DB"><polygon fill="#87CEEB" points="535.1245,204.3652,545.1245,208.3652,535.1245,212.3652,539.1245,208.3652" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="236" x2="541.1245" y1="208.3652" y2="208.3652"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="243" y="203.6357">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.0972" x="256.2422" y="203.6357">Query(PeerB ID)</text></g><path d="M562,221.3652 L562,262.3652 L755,262.3652 L755,231.3652 L745,221.3652 L562,221.3652" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M745,221.3652 L745,231.3652 L755,231.3652 L745,221.3652" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.8911" x="568" y="239.4351">Check local certified cache</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.5405" x="568" y="255.2344">for PeerB's certificate</text><g class="message" data-participant-1="DB" data-participant-2="PA"><polygon fill="#FFFFFF" points="247,285.7632,237,289.7632,247,293.7632,243,289.7632" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="241" x2="551.1245" y1="289.7632" y2="289.7632"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="253" y="285.0337">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="273.8823" x="266.2422" y="285.0337">Return Certificate (Signed by MasterPeer)</text></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="870.5176" x="5" y="318.6628"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="318.6628" y2="318.6628"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="321.6628" y2="321.6628"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="150.9888" x="364.7644" y="307.7632"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.5454" x="370.7644" y="324.833">Verification Phase</text><g class="message" data-participant-1="PA" data-participant-2="PA"><line style="stroke:#87CEEB;stroke-width:1;" x1="236" x2="278" y1="363.3618" y2="363.3618"/><line style="stroke:#87CEEB;stroke-width:1;" x1="278" x2="278" y1="363.3618" y2="376.3618"/><line style="stroke:#87CEEB;stroke-width:1;" x1="237" x2="278" y1="376.3618" y2="376.3618"/><polygon fill="#87CEEB" points="247,372.3618,237,376.3618,247,380.3618,243,376.3618" style="stroke:#87CEEB;stroke-width:1;"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="243" y="358.6323">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.2241" x="256.2422" y="358.6323">Verify Certificate</text></g><path d="M10,389.3618 L10,446.3618 L231,446.3618 L231,399.3618 L221,389.3618 L10,389.3618" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M221,389.3618 L221,399.3618 L231,399.3618 L221,389.3618" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="200.77" x="16" y="407.4316">1. Verify MasterPeer Signature</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.3911" x="16" y="423.231">2. Check Expiration</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.6406" x="16" y="439.0303">3. Extract PeerB Public Keys</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="870.5176" x="5" y="472.6594"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="472.6594" y2="472.6594"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="5" x2="875.5176" y1="475.6594" y2="475.6594"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="148.3926" x="366.0625" y="461.7598"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.9492" x="372.0625" y="478.8296">Connection Phase</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="628.9868,513.3584,638.9868,517.3584,628.9868,521.3584,632.9868,517.3584" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="236" x2="634.9868" y1="517.3584" y2="517.3584"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="243" y="512.6289">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="228.9409" x="256.2422" y="512.6289">AKE Request (Kyber Encapsulated)</text></g><path d="M655,530.3584 L655,571.3584 L870,571.3584 L870,540.3584 L860,530.3584 L655,530.3584" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M860,530.3584 L860,540.3584 L870,540.3584 L860,530.3584" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194.5176" x="661" y="548.4282">1. Decapsulate Shared Secret</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.5244" x="661" y="564.2275">2. Verify PeerA Identity</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="247,594.7563,237,598.7563,247,602.7563,243,598.7563" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="241" x2="644.9868" y1="598.7563" y2="598.7563"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="253" y="594.0269">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="174.8779" x="266.2422" y="594.0269">AKE Response (Encrypted)</text></g><path d="M210,611.7563 L210,636.7563 L670,636.7563 L670,621.7563 L660,611.7563 L210,611.7563" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M660,611.7563 L660,621.7563 L670,621.7563 L660,611.7563" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="311.7905" x="280.0981" y="629.8262">Secure P2P Channel Established (Aes256_Gcm)</text><!--SRC=[ZPHlJzim4CRV-rCSPHAjD10mZKr8dTIcAKEK4SWqQHeJSfrBQpLrCjk1HTE- -yvE2ouCjhohx_myl_lZRjavBX6gWal5s0wS5EMK5v1nlO0sPD1QgMQ6cOLK5TTy2LCk5ZDTrYgBogBKiBtllo0ZmvpNXHsNogvInlvp5fzAIweL2fbByJTvvH9-CQ1l-DXf9UDZfSvGRnAuyy1qTVhRsGw4fQENVBdBI6rJ8F0xDEKI7mTNLAb5ZQLjAdnQu2E2rQadIF57ZKfGyUH1te6wMOTQWudCSI8LRfGO6Dp7dnc4oqcujbB8YYlxdCn8taeAlAIoJdbPuPc2_P5noo2LjB9KREjL4iTNDuERw69oSGLzw6o_VnV5yR2p3Ws3q7WyF8eEN2WQH1_Z899Fytn_tqNIh-dd-7pZaliwpZzeWM7j03i9eXvqW1j81h11mp9k-PGRXCwa5FG8pcdzbIslLJVYOeuzVsiqX90cb1ssiaFOg8GnAosjL9nS3g4LJWuJk9Ds3butMninncjRgdevHSrOlq_TDQAyHTr0CdTS_JuZwDrl6zZVFn3JCLpMbDVr670wwZakUSlf8JdWi4dCFoyjPtFhBqPp50ieF9X0QbWk2KauickLKsrUSyUiWu946Odk4aUeInp9u1YkqDPQGVIG3DrKpXHfJXiuvuRUZbFiiGm3Hb_l5zJj7LgLVvJih7nw4rgrjHMOMvzmiBVEUV051yE9aQext5jL7_-ifFQsr-hD7lsqcjZQoY6ffmNzOPnXOpnbL2g5udyOgRk3ivXQGe_RMEYUDJHPY9NWbQaBuis2EJtPcs1EJecA6U7zJKZdN5DFKnGQhIzbLQfVS3ZDQAEaRLZIJYfKNhMlHJDLgQY6Bb7ffl98mM0I6epdS6j8jrvx53Ab_larZkQSkb50REZj5DAuTUuEq1o-FRev4SiU-mC0]--></g></svg>