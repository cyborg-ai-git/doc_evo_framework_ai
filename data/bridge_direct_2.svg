<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="605px" preserveAspectRatio="none" style="width:958px;height:605px;background:#000000;" version="1.1" viewBox="0 0 958 605" width="958px" zoomAndPan="magnify"><title>PeerB get_peer PeerA certificate from Local Cache or other secure channel</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="925.6221" x="15" y="37.1182">PeerB get_peer PeerA certificate from Local Cache or other secure channel</text><g><title>PeerA</title><rect fill="#87CEEB" height="295.9932" style="stroke:#000000;stroke-width:1;" width="10" x="608.677" y="207.3506"/></g><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="234.968" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="238.968" x2="238.968" y1="131.752" y2="521.3438"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="609.677" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="613.677" x2="613.677" y1="131.752" y2="521.3438"/></g><g><title>Bridge channel</title><rect fill="#000000" fill-opacity="0.00000" height="389.5918" width="8" x="716.6843" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;stroke-dasharray:5,5;" x1="720.3928" x2="720.3928" y1="131.752" y2="521.3438"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="215.6208" y="128.8125">PeerB</text><ellipse cx="238.968" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M238.968,89.7373 C242.968,89.7373 245.968,89.7373 249.968,85.7373 C257.968,85.7373 265.968,93.7373 265.968,101.7373 L265.968,105.7373 C265.968,109.7373 261.968,113.7373 257.968,113.7373 L219.968,113.7373 C215.968,113.7373 211.968,109.7373 211.968,105.7373 L211.968,101.7373 C211.968,93.7373 219.968,85.7373 227.968,85.7373 C231.968,89.7373 234.968,89.7373 238.968,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="215.6208" y="534.4189">PeerB</text><ellipse cx="238.968" cy="554.3584" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M238.968,574.3584 C242.968,574.3584 245.968,574.3584 249.968,570.3584 C257.968,570.3584 265.968,578.3584 265.968,586.3584 L265.968,590.3584 C265.968,594.3584 261.968,598.3584 257.968,598.3584 L219.968,598.3584 C215.968,598.3584 211.968,594.3584 211.968,590.3584 L211.968,586.3584 C211.968,578.3584 219.968,570.3584 227.968,570.3584 C231.968,574.3584 234.968,574.3584 238.968,574.3584" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="590.3435" y="128.8125">PeerA</text><ellipse cx="613.677" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M613.677,89.7373 C617.677,89.7373 620.677,89.7373 624.677,85.7373 C632.677,85.7373 640.677,93.7373 640.677,101.7373 L640.677,105.7373 C640.677,109.7373 636.677,113.7373 632.677,113.7373 L594.677,113.7373 C590.677,113.7373 586.677,109.7373 586.677,105.7373 L586.677,101.7373 C586.677,93.7373 594.677,85.7373 602.677,85.7373 C606.677,89.7373 609.677,89.7373 613.677,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="590.3435" y="534.4189">PeerA</text><ellipse cx="613.677" cy="554.3584" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M613.677,574.3584 C617.677,574.3584 620.677,574.3584 624.677,570.3584 C632.677,570.3584 640.677,578.3584 640.677,586.3584 L640.677,590.3584 C640.677,594.3584 636.677,598.3584 632.677,598.3584 L594.677,598.3584 C590.677,598.3584 586.677,594.3584 586.677,590.3584 L586.677,586.3584 C586.677,578.3584 594.677,570.3584 602.677,570.3584 C606.677,574.3584 609.677,574.3584 613.677,574.3584" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="SC"><path d="M663.3928,104.7373 L777.9758,104.7373 C782.9758,104.7373 782.9758,118.2446 782.9758,118.2446 C782.9758,118.2446 782.9758,131.752 777.9758,131.752 L663.3928,131.752 C658.3928,131.752 658.3928,118.2446 658.3928,118.2446 C658.3928,118.2446 658.3928,104.7373 663.3928,104.7373" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M777.9758,104.7373 C772.9758,104.7373 772.9758,118.2446 772.9758,118.2446 C772.9758,131.752 777.9758,131.752 777.9758,131.752" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="663.3928" y="123.8125">Bridge channel</text></g><g class="participant participant-tail" data-participant="SC"><path d="M663.3928,520.3438 L777.9758,520.3438 C782.9758,520.3438 782.9758,533.8511 782.9758,533.8511 C782.9758,533.8511 782.9758,547.3584 777.9758,547.3584 L663.3928,547.3584 C658.3928,547.3584 658.3928,533.8511 658.3928,533.8511 C658.3928,533.8511 658.3928,520.3438 663.3928,520.3438" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M777.9758,520.3438 C772.9758,520.3438 772.9758,533.8511 772.9758,533.8511 C772.9758,547.3584 777.9758,547.3584 777.9758,547.3584" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.583" x="663.3928" y="539.4189">Bridge channel</text></g><g><title>PeerA</title><rect fill="#87CEEB" height="295.9932" style="stroke:#000000;stroke-width:1;" width="10" x="608.677" y="207.3506"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="858.686" x="48.968" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="387.0459" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="393.0459" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="596.677,203.3506,606.677,207.3506,596.677,211.3506,600.677,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="238.968" x2="602.677" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="245.968" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="337.4668" x="259.2102" y="202.6211">EApiEvent(Kyber Ciphertext,Api request,id_peer_b)</text></g><path d="M622.968,220.3506 L622.968,277.3506 L901.968,277.3506 L901.968,230.3506 L891.968,220.3506 L622.968,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M891.968,220.3506 L891.968,230.3506 L901.968,230.3506 L891.968,220.3506" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.9087" x="628.968" y="238.4204">1. Decapsulate Kyber</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2402" x="628.968" y="254.2197">2.Verify sign</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="258.686" x="628.968" y="270.019">3. get_peer PeerB (cache, Master Peer)</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="249.968,300.5479,239.968,304.5479,249.968,308.5479,245.968,304.5479" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="243.968" x2="607.677" y1="304.5479" y2="304.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="255.968" y="299.8184">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="176.2808" x="269.2102" y="299.8184">Recive EApiEvent response</text></g><path d="M53.968,317.5479 L53.968,358.5479 L233.968,358.5479 L233.968,327.5479 L223.968,317.5479 L53.968,317.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M223.968,317.5479 L223.968,327.5479 L233.968,327.5479 L223.968,317.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.9121" x="59.968" y="335.6177">1. Decrypt EApiEvent</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.3389" x="59.968" y="351.417">2. Store new Secret Key</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="858.686" x="48.968" y="385.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="385.0461" y2="385.0461"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="388.0461" y2="388.0461"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="299.3652" x="328.6284" y="374.1465"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280.9219" x="334.6284" y="391.2163">Other EApiEvent Request/Response ...</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="858.686" x="48.968" y="428.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="428.8455" y2="428.8455"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="48.968" x2="907.6541" y1="431.8455" y2="431.8455"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="174.5894" x="391.0164" y="417.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.146" x="397.0164" y="435.0156">Channel Maintenance</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="708.6843,469.5444,718.6843,473.5444,708.6843,477.5444,712.6843,473.5444" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="238.968" x2="714.6843" y1="473.5444" y2="473.5444"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="245.968" y="468.8149">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9751" x="259.2102" y="468.8149">Keepalive</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="624.677,499.3438,614.677,503.3438,624.677,507.3438,620.677,503.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="618.677" x2="719.6843" y1="503.3438" y2="503.3438"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="630.677" y="498.6143">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.7651" x="643.9192" y="498.6143">Heartbeat</text></g><!--SRC=[bLLjJzim4FxkNt4Kf8447MpQ64YTb8J09kZAccaQ6XDoqsjhaTgPxPHrQFzzPoUbANtHvWzLVFVuxhd7v-kM7U4O8S-ua8ozW8jCzNW6VQxleNGPj5R8eM7cNiYSQpw67a_lXreLiX-fJ6dOFlIhXkZZW1UPFLVILf1plroAJyfIr1nJCH3fgl3I0HuPq0gVPwh2U9_IVTIB39ozbhIo_d5fWzIIQIal741Xw0F6Igfqf9KhsKuph17YxcZYZC0Vq13akREYcrZKgEmqn-NAdr6hh9vQH6QjiesYf1NcSKsWcJKHln6EZbUgjzCEaYznz-uwff-eSzNfBWcv1fAaFCDlSDHyCz_U-Aqlu7E1nUOx_UaH_tcfgvMhNsg255YcvPLHobf6CtELIQ_40A-4n7K9dlnhUjjXhhcs8XKvbtPTc0iwcc-AKG9KV_eFe0qfLZV0cPW8EhCfz0oo9dZbNjkeP39iQyUtHr0s2BIWiVtkE8hZi46kfGRo_fF3E3uvRCoEXZNN-NduDZfohkI6ZhONN6xvg76xqxrPwGgx7yykuffhC73LDXpXseqPLhxKnZLI-GtW1gv3MA1JHmGb8e25MbdPnurGY_uG8HrnAJ7pq2I21IgCMM5fOlXqC4HxbzENtmQG8l6Yfy9fqWrevi2LeYS54Kz724H1qUobOOLfeP-o06Eyi4eMunvgrcfHyniZb8JOMDxBX1cDKLfejHYZmWw-BvJsuptLSWfna8juGh3Toob5WKZabCZYBxjF7j3kpHYxB_gUx5rlpqaY9excaXH-J6in75aV-gW9PvZot1IPW_luj_9LyojgCPY24KDvAryt5vK8OJTrDUz3cnjR6VUeWE2fW61UG7WANHen4vpNGPHDhgJ1aaw60-jn9HizpUqSwzZGY5OagSG7aY_LQE4IfyofsV6IpmDtIorUTgi4q6mslRWE75LNqgQ_JOkIkpcpLlWaEgKicFECg3Fg4uBKEwMwcmz8pTf3RXdhOqtslm00]--></g></svg>