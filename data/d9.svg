<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="823px" preserveAspectRatio="none" style="width:517px;height:823px;background:#000000;" version="1.1" viewBox="0 0 517 823" width="517px" zoomAndPan="magnify"><title>Diagram 6: Full Secure Messaging Flow</title><defs/><g><text fill="#FFFFFF" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="484.9775" x="15" y="37.1182">Diagram 6: Full Secure Messaging Flow</text><g><title>PeerA</title><rect fill="#000000" height="459.1904" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="400.8992" y="237.1499"/></g><rect fill="#FFFFFF" height="77.3979" style="stroke:#000000;stroke-width:1;" width="371.8208" x="72.0784" y="516.5444"/><g><title>PeerB</title><rect fill="#000000" fill-opacity="0.00000" height="582.5884" width="8" x="106.0784" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="110.0784" x2="110.0784" y1="131.752" y2="714.3403"/></g><g><title>Bridge Channel</title><rect fill="#000000" fill-opacity="0.00000" height="582.5884" width="8" x="281.2234" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="284.6912" x2="284.6912" y1="131.752" y2="714.3403"/></g><g><title>PeerA</title><rect fill="#000000" fill-opacity="0.00000" height="582.5884" width="8" x="401.8992" y="131.752"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="405.8992" x2="405.8992" y1="131.752" y2="714.3403"/></g><g class="participant participant-head" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="86.7312" y="128.8125">PeerB</text><ellipse cx="110.0784" cy="69.7373" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M110.0784,89.7373 C114.0784,89.7373 117.0784,89.7373 121.0784,85.7373 C129.0784,85.7373 137.0784,93.7373 137.0784,101.7373 L137.0784,105.7373 C137.0784,109.7373 133.0784,113.7373 129.0784,113.7373 L91.0784,113.7373 C87.0784,113.7373 83.0784,109.7373 83.0784,105.7373 L83.0784,101.7373 C83.0784,93.7373 91.0784,85.7373 99.0784,85.7373 C103.0784,89.7373 106.0784,89.7373 110.0784,89.7373" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PB"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.6943" x="86.7312" y="727.4155">PeerB</text><ellipse cx="110.0784" cy="747.355" fill="#FFB6C1" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M110.0784,767.355 C114.0784,767.355 117.0784,767.355 121.0784,763.355 C129.0784,763.355 137.0784,771.355 137.0784,779.355 L137.0784,783.355 C137.0784,787.355 133.0784,791.355 129.0784,791.355 L91.0784,791.355 C87.0784,791.355 83.0784,787.355 83.0784,783.355 L83.0784,779.355 C83.0784,771.355 91.0784,763.355 99.0784,763.355 C103.0784,767.355 106.0784,767.355 110.0784,767.355" fill="#FFB6C1" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="SC"><path d="M226.6912,104.7373 L343.7556,104.7373 C348.7556,104.7373 348.7556,118.2446 348.7556,118.2446 C348.7556,118.2446 348.7556,131.752 343.7556,131.752 L226.6912,131.752 C221.6912,131.752 221.6912,118.2446 221.6912,118.2446 C221.6912,118.2446 221.6912,104.7373 226.6912,104.7373" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M343.7556,104.7373 C338.7556,104.7373 338.7556,118.2446 338.7556,118.2446 C338.7556,131.752 343.7556,131.752 343.7556,131.752" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="107.0645" x="226.6912" y="123.8125">Bridge Channel</text></g><g class="participant participant-tail" data-participant="SC"><path d="M226.6912,713.3403 L343.7556,713.3403 C348.7556,713.3403 348.7556,726.8477 348.7556,726.8477 C348.7556,726.8477 348.7556,740.355 343.7556,740.355 L226.6912,740.355 C221.6912,740.355 221.6912,726.8477 221.6912,726.8477 C221.6912,726.8477 221.6912,713.3403 226.6912,713.3403" fill="#FF0000" style="stroke:#FFFFFF;stroke-width:1;"/><path d="M343.7556,713.3403 C338.7556,713.3403 338.7556,726.8477 338.7556,726.8477 C338.7556,740.355 343.7556,740.355 343.7556,740.355" fill="none" style="stroke:#FFFFFF;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="107.0645" x="226.6912" y="732.4155">Bridge Channel</text></g><g class="participant participant-head" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="382.5657" y="128.8125">PeerA</text><ellipse cx="405.8992" cy="69.7373" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M405.8992,89.7373 C409.8992,89.7373 412.8992,89.7373 416.8992,85.7373 C424.8992,85.7373 432.8992,93.7373 432.8992,101.7373 L432.8992,105.7373 C432.8992,109.7373 428.8992,113.7373 424.8992,113.7373 L386.8992,113.7373 C382.8992,113.7373 378.8992,109.7373 378.8992,105.7373 L378.8992,101.7373 C378.8992,93.7373 386.8992,85.7373 394.8992,85.7373 C398.8992,89.7373 401.8992,89.7373 405.8992,89.7373" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="PA"><text fill="#FFFFFF" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.667" x="382.5657" y="727.4155">PeerA</text><ellipse cx="405.8992" cy="747.355" fill="#87CEEB" rx="16" ry="16" style="stroke:#000000;stroke-width:1;"/><path d="M405.8992,767.355 C409.8992,767.355 412.8992,767.355 416.8992,763.355 C424.8992,763.355 432.8992,771.355 432.8992,779.355 L432.8992,783.355 C432.8992,787.355 428.8992,791.355 424.8992,791.355 L386.8992,791.355 C382.8992,791.355 378.8992,787.355 378.8992,783.355 L378.8992,779.355 C378.8992,771.355 386.8992,763.355 394.8992,763.355 C398.8992,767.355 401.8992,767.355 405.8992,767.355" fill="#87CEEB" style="stroke:#000000;stroke-width:1;"/></g><g><title>PeerA</title><rect fill="#000000" height="459.1904" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="400.8992" y="237.1499"/></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="391.8208" x="62.0784" y="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="162.6516" y2="162.6516"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="165.6516" y2="165.6516"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="182.5303" x="166.7236" y="151.752"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.0869" x="172.7236" y="168.8218">Session Establishment</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="273.2234,203.3506,283.2234,207.3506,273.2234,211.3506,277.2234,207.3506" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="110.0784" x2="279.2234" y1="207.3506" y2="207.3506"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="117.0784" y="202.6211">1</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.9028" x="130.3206" y="202.6211">AKE Request (Kyber)</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="388.8992,233.1499,398.8992,237.1499,388.8992,241.1499,392.8992,237.1499" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="285.2234" x2="394.8992" y1="237.1499" y2="237.1499"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="292.2234" y="232.4204">2</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="83.4336" x="305.4656" y="232.4204">AKE Request</text></g><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="121.0784,262.9492,111.0784,266.9492,121.0784,270.9492,117.0784,266.9492" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="115.0784" x2="399.8992" y1="266.9492" y2="266.9492"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="127.0784" y="262.2197">3</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105.9551" x="140.3206" y="262.2197">Session Confirm</text></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="391.8208" x="62.0784" y="295.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="295.8489" y2="295.8489"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="298.8489" y2="298.8489"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="127.1216" x="194.428" y="284.9492"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.6782" x="200.428" y="302.019">Data Exchange</text><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#FFB6C1" points="388.8992,336.5479,398.8992,340.5479,388.8992,344.5479,392.8992,340.5479" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="110.0784" x2="394.8992" y1="340.5479" y2="340.5479"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="117.0784" y="335.8184">4</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.3184" x="130.3206" y="335.8184">AUTH_DATA[0]</text></g><path d="M115.0784,353.5479 L115.0784,394.5479 L268.0784,394.5479 L268.0784,363.5479 L258.0784,353.5479 L115.0784,353.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M258.0784,353.5479 L258.0784,363.5479 L268.0784,363.5479 L258.0784,353.5479" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.7041" x="121.0784" y="371.6177">ChaCha20-Poly1305</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.1309" x="121.0784" y="387.417">Nonce per packet</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#87CEEB" points="121.0784,417.9458,111.0784,421.9458,121.0784,425.9458,117.0784,421.9458" style="stroke:#87CEEB;stroke-width:1;"/><line style="stroke:#87CEEB;stroke-width:1;" x1="115.0784" x2="399.8992" y1="421.9458" y2="421.9458"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="127.0784" y="417.2163">5</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.4072" x="140.3206" y="417.2163">ENC_RESPONSE[0]</text></g><path d="M254.0784,434.9458 L254.0784,459.9458 L395.0784,459.9458 L395.0784,444.9458 L385.0784,434.9458 L254.0784,434.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M385.0784,434.9458 L385.0784,444.9458 L395.0784,444.9458 L385.0784,434.9458" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.7197" x="260.0784" y="453.0156">Anti-replay checks</text><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="391.8208" x="62.0784" y="486.6448"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="486.6448" y2="486.6448"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="489.6448" y2="489.6448"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="102.7275" x="206.625" y="475.7451"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.2842" x="212.625" y="492.8149">Rekey Loop</text><path d="M72.0784,516.5444 L148.4612,516.5444 L148.4612,524.3438 L138.4612,534.3438 L72.0784,534.3438 L72.0784,516.5444" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="77.3979" style="stroke:#000000;stroke-width:1;" width="371.8208" x="72.0784" y="516.5444"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.3828" x="87.0784" y="530.6143">loop</text><text fill="#FFFFFF" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.4712" x="163.4612" y="529.6035">[Every 1 MB or 24 h]</text><g class="message" data-participant-1="PA" data-participant-2="PB"><polygon fill="#000000" points="121.0784,552.1431,111.0784,556.1431,121.0784,560.1431,117.0784,556.1431" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="115.0784" x2="399.8992" y1="556.1431" y2="556.1431"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="127.0784" y="551.4136">6</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.2334" x="140.3206" y="551.4136">Rekey Request</text></g><g class="message" data-participant-1="PB" data-participant-2="PA"><polygon fill="#000000" points="388.8992,581.9424,398.8992,585.9424,388.8992,589.9424,392.8992,585.9424" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="110.0784" x2="394.8992" y1="585.9424" y2="585.9424"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="117.0784" y="581.2129">7</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.0083" x="130.3206" y="581.2129">Rekey Confirm</text></g><rect fill="#000000" height="3" style="stroke:#000000;stroke-width:1;" width="391.8208" x="62.0784" y="621.842"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="621.842" y2="621.842"/><line style="stroke:#FFFFFF;stroke-width:0.5;" x1="62.0784" x2="453.8992" y1="624.842" y2="624.842"/><rect fill="#000000" height="23.7993" style="stroke:#FFFFFF;stroke-width:1;" width="174.5894" x="170.6941" y="610.9424"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.146" x="176.6941" y="628.0122">Channel Maintenance</text><g class="message" data-participant-1="PB" data-participant-2="SC"><polygon fill="#FFB6C1" points="273.2234,662.541,283.2234,666.541,273.2234,670.541,277.2234,666.541" style="stroke:#FFB6C1;stroke-width:1;"/><line style="stroke:#FFB6C1;stroke-width:1;" x1="110.0784" x2="279.2234" y1="666.541" y2="666.541"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="117.0784" y="661.8115">8</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.9751" x="130.3206" y="661.8115">Keepalive</text></g><g class="message" data-participant-1="SC" data-participant-2="PA"><polygon fill="#FF0000" points="393.8992,692.3403,403.8992,696.3403,393.8992,700.3403,397.8992,696.3403" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="285.2234" x2="399.8992" y1="696.3403" y2="696.3403"/><text fill="#FFFFFF" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="292.2234" y="691.6108">9</text><text fill="#FFFFFF" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="64.7651" x="305.4656" y="691.6108">Heartbeat</text></g><text fill="#FFFFFF" font-family="Verdana" font-size="10" lengthAdjust="spacing" textLength="249.4434" x="132.7671" y="808.4087">Secure Messaging Protocol v1.4 | IETF-Compliant</text><!--SRC=[bLHTRzf047o_Nx4X3sqVg21DqYeIbMnZaYYGM40VgZH2Xrd3YVETUtScHMt_UzVc8uP0fAwGa7pZsTdPEP-u6QO8cUH2CVOE0YrrRY3MoZgkd6Kd4qo4GeZ2i3_oHi53zw4FPPr- -Ho4eR-By7SGdOv_6JIt2Bz_sxuETn19qg3Q8WRV1yEmjyTHLA7jMkenbs3TKWerPNOkLCODJs7Cu_dKw5nD2la6JXjbLH14ptFfEbgvDMHD-mBXiTDcGDm8_1cjJh5o-3F77E4t0_3tUws9w4IR2PhzfvMMQrL_AxnAk_-YNLCSfYMB1aXALOm7JBARew9TLoJO9SCFQzwU7l4L8EB6YLXa597356sn4FJuECC6yDRRhzTL3bbfRbcvDgX5I5mrU2bk8V9tCibMIwpvHaoc2C6CAuMoLa87mKuugwpUFgktSnSOSy9HPjg2JmkRBw-Waqj9cuXpWz13Q_cKDW4TgPyPpvrMUJf6mrYhHI1hXLOGqcKRIs5dAIe7hHOZwVN7glYdhwJn2hox4Fh58gs3ztTBuld0I7lziQgUi96tWotc4GjEMOiyHWEikRqNl7-r5HDebGYJbWBRt748VyNa5LbsH5ZPxDlmPjJsXjvZuucLgJPYEdCbCJbDlxD6FT9osVpKkFYXxdMHn0mDP9GGTEoegl0-6FN3GVHmFmYtt18JjsghdAWRfC_N4k8PndDRokxZ79VGrJehDClYFroWMK8JUZxGPi_EOLR4c9gksgpUsDW5HNRggybM9njJK4tA3klqG8- -cmuLByPvOsztY1cNOe57jtM3bEenSiScMDqMIpHDJ5by5QZ8QATZBM7H_7WEV-0s77RgWKupAUXcrFu1]--></g></svg>